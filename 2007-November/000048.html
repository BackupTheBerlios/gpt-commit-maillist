<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [gpt-commit] r374 - in trunk/gpt2: . common common/src gptasm	gptasm/src gptasm/test gptasm/test/gerados_pelo_gptc	gptasm/test/wikki gptvm gptvm/src gptvm/test	gptvm/test/gerados_pelo_gptasm
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/gpt-commit/2007-November/index.html" >
   <LINK REL="made" HREF="mailto:gpt-commit%40lists.berlios.de?Subject=Re%3A%20%5Bgpt-commit%5D%20r374%20-%20in%20trunk/gpt2%3A%20.%20common%20common/src%20gptasm%0A%09gptasm/src%20gptasm/test%20gptasm/test/gerados_pelo_gptc%0A%09gptasm/test/wikki%20gptvm%20gptvm/src%20gptvm/test%0A%09gptvm/test/gerados_pelo_gptasm&In-Reply-To=%3C200711191953.lAJJrhou007669%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000047.html">
   <LINK REL="Next"  HREF="000049.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[gpt-commit] r374 - in trunk/gpt2: . common common/src gptasm	gptasm/src gptasm/test gptasm/test/gerados_pelo_gptc	gptasm/test/wikki gptvm gptvm/src gptvm/test	gptvm/test/gerados_pelo_gptasm</H1>
    <B>gpt-commit-noreply at mail.berlios.de</B> 
    <A HREF="mailto:gpt-commit%40lists.berlios.de?Subject=Re%3A%20%5Bgpt-commit%5D%20r374%20-%20in%20trunk/gpt2%3A%20.%20common%20common/src%20gptasm%0A%09gptasm/src%20gptasm/test%20gptasm/test/gerados_pelo_gptc%0A%09gptasm/test/wikki%20gptvm%20gptvm/src%20gptvm/test%0A%09gptvm/test/gerados_pelo_gptasm&In-Reply-To=%3C200711191953.lAJJrhou007669%40sheep.berlios.de%3E"
       TITLE="[gpt-commit] r374 - in trunk/gpt2: . common common/src gptasm	gptasm/src gptasm/test gptasm/test/gerados_pelo_gptc	gptasm/test/wikki gptvm gptvm/src gptvm/test	gptvm/test/gerados_pelo_gptasm">gpt-commit-noreply at mail.berlios.de
       </A><BR>
    <I>Mon Nov 19 20:53:43 CET 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="000047.html">[gpt-commit] r373 - in trunk/gpt2/gptc: . src test
</A></li>
        <LI>Next message: <A HREF="000049.html">[gpt-commit] r375 - trunk/gpt2/gptc/src
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#48">[ date ]</a>
              <a href="thread.html#48">[ thread ]</a>
              <a href="subject.html#48">[ subject ]</a>
              <a href="author.html#48">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: alexgarzao
Date: 2007-11-19 20:53:34 +0100 (Mon, 19 Nov 2007)
New Revision: 374

Added:
   trunk/gpt2/common/
   trunk/gpt2/common/src/
   trunk/gpt2/common/src/CBinString.cpp
   trunk/gpt2/common/src/CBinString.hpp
   trunk/gpt2/common/src/CCode.cpp
   trunk/gpt2/common/src/CCode.hpp
   trunk/gpt2/common/src/CData.cpp
   trunk/gpt2/common/src/CData.hpp
   trunk/gpt2/common/src/CHeader.cpp
   trunk/gpt2/common/src/CHeader.hpp
   trunk/gpt2/common/src/COptions.hpp
   trunk/gpt2/common/src/CSymbol.cpp
   trunk/gpt2/common/src/CSymbol.hpp
   trunk/gpt2/common/src/CSymbolList.cpp
   trunk/gpt2/common/src/CSymbolList.hpp
   trunk/gpt2/common/src/CSymbolTable.cpp
   trunk/gpt2/common/src/CSymbolTable.hpp
   trunk/gpt2/common/src/Common.hpp
   trunk/gpt2/common/test/
   trunk/gpt2/gptasm/src/
   trunk/gpt2/gptasm/src/CGenBytecode.cpp
   trunk/gpt2/gptasm/src/CGenBytecode.hpp
   trunk/gpt2/gptasm/src/CGptAsm.cpp
   trunk/gpt2/gptasm/src/CGptAsm.hpp
   trunk/gpt2/gptasm/src/Makefile
   trunk/gpt2/gptasm/src/lexer.g
   trunk/gpt2/gptasm/src/main.cpp
   trunk/gpt2/gptasm/src/parser.g
   trunk/gpt2/gptasm/test/
   trunk/gpt2/gptasm/test/asm.sh
   trunk/gpt2/gptasm/test/asm_all.sh
   trunk/gpt2/gptasm/test/check.sh
   trunk/gpt2/gptasm/test/check_all.sh
   trunk/gpt2/gptasm/test/gerados_pelo_gptc/
   trunk/gpt2/gptasm/test/gerados_pelo_gptc/constantes_1.gasm
   trunk/gpt2/gptasm/test/gerados_pelo_gptc/estruturas_condicionais_1.gasm
   trunk/gpt2/gptasm/test/gerados_pelo_gptc/estruturas_condicionais_2.gasm
   trunk/gpt2/gptasm/test/gerados_pelo_gptc/estruturas_condicionais_3.gasm
   trunk/gpt2/gptasm/test/gerados_pelo_gptc/estruturas_condicionais_4.gasm
   trunk/gpt2/gptasm/test/gerados_pelo_gptc/estruturas_condicionais_5.gasm
   trunk/gpt2/gptasm/test/gerados_pelo_gptc/estruturas_repeticao_1.gasm
   trunk/gpt2/gptasm/test/gerados_pelo_gptc/estruturas_repeticao_2.gasm
   trunk/gpt2/gptasm/test/gerados_pelo_gptc/estruturas_repeticao_3.gasm
   trunk/gpt2/gptasm/test/gerados_pelo_gptc/estruturas_repeticao_4.gasm
   trunk/gpt2/gptasm/test/gerados_pelo_gptc/expressoes_matematicas_1.gasm
   trunk/gpt2/gptasm/test/gerados_pelo_gptc/expressoes_matematicas_2.gasm
   trunk/gpt2/gptasm/test/gerados_pelo_gptc/funcoes_definidas_usuario_1.gasm
   trunk/gpt2/gptasm/test/gerados_pelo_gptc/funcoes_definidas_usuario_2.gasm
   trunk/gpt2/gptasm/test/gerados_pelo_gptc/inline_codigo_gptassembly.gasm
   trunk/gpt2/gptasm/test/gerados_pelo_gptc/invocando_subrotinas_linguagem_1.gasm
   trunk/gpt2/gptasm/test/gerados_pelo_gptc/invocando_subrotinas_linguagem_2.gasm
   trunk/gpt2/gptasm/test/gerados_pelo_gptc/matrizes_1.gasm
   trunk/gpt2/gptasm/test/gerados_pelo_gptc/matrizes_2.gasm
   trunk/gpt2/gptasm/test/gerados_pelo_gptc/matrizes_3.gasm
   trunk/gpt2/gptasm/test/gerados_pelo_gptc/matrizes_4.gasm
   trunk/gpt2/gptasm/test/gerados_pelo_gptc/procedimentos_definidos_usuario_1.gasm
   trunk/gpt2/gptasm/test/gerados_pelo_gptc/procedimentos_definidos_usuario_2.gasm
   trunk/gpt2/gptasm/test/gerados_pelo_gptc/procedimentos_definidos_usuario_3.gasm
   trunk/gpt2/gptasm/test/gerados_pelo_gptc/procedimentos_definidos_usuario_4.gasm
   trunk/gpt2/gptasm/test/gerados_pelo_gptc/variaveis_1.gasm
   trunk/gpt2/gptasm/test/gerados_pelo_gptc/variaveis_2.gasm
   trunk/gpt2/gptasm/test/gerados_pelo_gptc/variaveis_3.gasm
   trunk/gpt2/gptasm/test/gerados_pelo_gptc/variaveis_4.gasm
   trunk/gpt2/gptasm/test/gerados_pelo_gptc/variaveis_5.gasm
   trunk/gpt2/gptasm/test/gerados_pelo_gptc/variaveis_6.gasm
   trunk/gpt2/gptasm/test/gerados_pelo_gptc/variaveis_7.gasm
   trunk/gpt2/gptasm/test/gerados_pelo_gptc/variaveis_8.gasm
   trunk/gpt2/gptasm/test/hello_world.gasm
   trunk/gpt2/gptasm/test/prep_tests.sh
   trunk/gpt2/gptasm/test/show_and_asm.sh
   trunk/gpt2/gptasm/test/test_ok.sh
   trunk/gpt2/gptasm/test/test_ok_all.sh
   trunk/gpt2/gptasm/test/wikki/
   trunk/gpt2/gptasm/test/wikki/enderecamento_1.gasm
   trunk/gpt2/gptasm/test/wikki/estruturas_condicionais_1.gasm
   trunk/gpt2/gptasm/test/wikki/estruturas_repeticao_1.gasm
   trunk/gpt2/gptasm/test/wikki/expressoes_matematicas_1.gasm
   trunk/gpt2/gptasm/test/wikki/funcoes_definidas_usuario_1.gasm
   trunk/gpt2/gptasm/test/wikki/invocando_subrotinas_linguagem_1.gasm
   trunk/gpt2/gptasm/test/wikki/invocando_subrotinas_linguagem_2.gasm
   trunk/gpt2/gptasm/test/wikki/procedimentos_definidos_usuario_1.gasm
   trunk/gpt2/gptasm/test/wikki/procedimentos_definidos_usuario_2.gasm
   trunk/gpt2/gptasm/test/wikki/variaveis_1.gasm
   trunk/gpt2/gptasm/test/wikki/variaveis_2.gasm
   trunk/gpt2/gptasm/test/wikki/variaveis_3.gasm
   trunk/gpt2/gptasm/test/wikki/variaveis_4.gasm
   trunk/gpt2/gptasm/test/wikki/variaveis_5.gasm
   trunk/gpt2/gptasm/test/wikki/variaveis_6.gasm
   trunk/gpt2/gptvm/src/
   trunk/gpt2/gptvm/src/CDataStack.cpp
   trunk/gpt2/gptvm/src/CDataStack.hpp
   trunk/gpt2/gptvm/src/CGptVm.cpp
   trunk/gpt2/gptvm/src/CGptVm.hpp
   trunk/gpt2/gptvm/src/CRunBytecode.cpp
   trunk/gpt2/gptvm/src/CRunBytecode.hpp
   trunk/gpt2/gptvm/src/Makefile
   trunk/gpt2/gptvm/src/main.cpp
   trunk/gpt2/gptvm/test/
   trunk/gpt2/gptvm/test/check.sh
   trunk/gpt2/gptvm/test/check_all.sh
   trunk/gpt2/gptvm/test/gerados_pelo_gptasm/
   trunk/gpt2/gptvm/test/gerados_pelo_gptasm/constantes_1.gvm
   trunk/gpt2/gptvm/test/gerados_pelo_gptasm/estruturas_condicionais_1.gvm
   trunk/gpt2/gptvm/test/gerados_pelo_gptasm/estruturas_condicionais_2.gvm
   trunk/gpt2/gptvm/test/gerados_pelo_gptasm/estruturas_condicionais_3.gvm
   trunk/gpt2/gptvm/test/gerados_pelo_gptasm/estruturas_condicionais_4.gvm
   trunk/gpt2/gptvm/test/gerados_pelo_gptasm/estruturas_condicionais_5.gvm
   trunk/gpt2/gptvm/test/gerados_pelo_gptasm/estruturas_repeticao_1.gvm
   trunk/gpt2/gptvm/test/gerados_pelo_gptasm/estruturas_repeticao_2.gvm
   trunk/gpt2/gptvm/test/gerados_pelo_gptasm/estruturas_repeticao_3.gvm
   trunk/gpt2/gptvm/test/gerados_pelo_gptasm/estruturas_repeticao_4.gvm
   trunk/gpt2/gptvm/test/gerados_pelo_gptasm/expressoes_matematicas_1.gvm
   trunk/gpt2/gptvm/test/gerados_pelo_gptasm/expressoes_matematicas_2.gvm
   trunk/gpt2/gptvm/test/gerados_pelo_gptasm/funcoes_definidas_usuario_1.gvm
   trunk/gpt2/gptvm/test/gerados_pelo_gptasm/funcoes_definidas_usuario_2.gvm
   trunk/gpt2/gptvm/test/gerados_pelo_gptasm/inline_codigo_gptassembly.gvm
   trunk/gpt2/gptvm/test/gerados_pelo_gptasm/invocando_subrotinas_linguagem_1.gvm
   trunk/gpt2/gptvm/test/gerados_pelo_gptasm/invocando_subrotinas_linguagem_2.gvm
   trunk/gpt2/gptvm/test/gerados_pelo_gptasm/matrizes_1.gvm
   trunk/gpt2/gptvm/test/gerados_pelo_gptasm/matrizes_3.gvm
   trunk/gpt2/gptvm/test/gerados_pelo_gptasm/matrizes_4.gvm
   trunk/gpt2/gptvm/test/gerados_pelo_gptasm/procedimentos_definidos_usuario_1.gvm
   trunk/gpt2/gptvm/test/gerados_pelo_gptasm/procedimentos_definidos_usuario_2.gvm
   trunk/gpt2/gptvm/test/gerados_pelo_gptasm/procedimentos_definidos_usuario_3.gvm
   trunk/gpt2/gptvm/test/gerados_pelo_gptasm/procedimentos_definidos_usuario_4.gvm
   trunk/gpt2/gptvm/test/gerados_pelo_gptasm/variaveis_1.gvm
   trunk/gpt2/gptvm/test/gerados_pelo_gptasm/variaveis_2.gvm
   trunk/gpt2/gptvm/test/gerados_pelo_gptasm/variaveis_3.gvm
   trunk/gpt2/gptvm/test/gerados_pelo_gptasm/variaveis_4.gvm
   trunk/gpt2/gptvm/test/gerados_pelo_gptasm/variaveis_5.gvm
   trunk/gpt2/gptvm/test/gerados_pelo_gptasm/variaveis_6.gvm
   trunk/gpt2/gptvm/test/gerados_pelo_gptasm/variaveis_7.gvm
   trunk/gpt2/gptvm/test/gerados_pelo_gptasm/variaveis_8.gvm
   trunk/gpt2/gptvm/test/prep_tests.sh
   trunk/gpt2/gptvm/test/run.sh
   trunk/gpt2/gptvm/test/run_all.sh
   trunk/gpt2/gptvm/test/test_ok.sh
   trunk/gpt2/gptvm/test/test_ok_all.sh
Log:
* Gramatica parcial do GptAssembly
* GptASM
  - Gera parcialmente o arquivo GVM
  - Consegue assemblar &quot;Hello world !!!&quot;
  - Alguns exemplos estao sendo assemblados corretamente mas a VM
    nao consegue executa-los no momento
* GptVM
  - Carrega parcialmente o arquivo GVM
  - Consegue executar &quot;Hello world !!!&quot;
  - Consegue executar alguns exemplos com formula matematicas com inteiros


Added: trunk/gpt2/common/src/CBinString.cpp
===================================================================
--- trunk/gpt2/common/src/CBinString.cpp	2007-11-19 03:48:19 UTC (rev 373)
+++ trunk/gpt2/common/src/CBinString.cpp	2007-11-19 19:53:34 UTC (rev 374)
@@ -0,0 +1,115 @@
+#include &lt;iostream&gt;
+
+#include &quot;CBinString.hpp&quot;
+
+
+void CBinString::writeInt(const int &amp;value)
+{
+   char *byte = (char*)&value;
+
+   for( size_t i = 0; i &lt; sizeof(int); i++) {
+      push_back(*byte);
+      byte++;
+   }
+//   std::cout &lt;&lt; &quot;writeInt:&quot; &lt;&lt; value &lt;&lt; std::endl;
+}
+
+
+void CBinString::writeByte(const char &amp;value)
+{
+   (*this) += value;
+//   std::cout &lt;&lt; &quot;writeByte:&quot; &lt;&lt; value &lt;&lt; &quot;(&quot; &lt;&lt; (int)value &lt;&lt; &quot;)&quot; &lt;&lt; std::endl;
+}
+
+
+void CBinString::writeString(const std::string &amp;value, const bool &amp;writeSize)
+{
+   if (writeSize) {
+      writeInt(value.length());
+   }
+   (*this) += value;
+   if (!writeSize) {
+      (*this) += '\0';
+   }
+//   std::cout &lt;&lt; &quot;writeString: [&quot; &lt;&lt; value &lt;&lt; &quot;]&quot; &lt;&lt; std::endl;
+}
+
+
+void CBinString::writeBool(const bool &amp;value)
+{
+   char byte = (char)value;
+
+   (*this) += byte;
+//   std::cout &lt;&lt; &quot;writeBool:&quot; &lt;&lt; value &lt;&lt; std::endl;
+}
+
+
+void CBinString::readInt(int &amp;value)
+{
+   int result = 0;
+   char *byte = (char*)&result;
+
+   for( size_t i = 0; i &lt; sizeof(int); i++) {
+      *byte = (*this)[0]; // TODO
+      byte++;
+      erase(0,1);
+   }
+   value = result;
+//   std::cout &lt;&lt; &quot;readInt:&quot; &lt;&lt; value &lt;&lt; std::endl;
+}
+
+
+void CBinString::readByte(char &amp;value)
+{
+   value = (*this)[0];
+   erase(0,1);
+//   std::cout &lt;&lt; &quot;readByte:&quot; &lt;&lt; value &lt;&lt; &quot;(&quot; &lt;&lt; (int)value &lt;&lt; &quot;)&quot; &lt;&lt; std::endl;
+}
+
+
+void CBinString::readString(std::string &amp;value)
+{
+   int size;
+   readInt(size);
+   value=substr(0, size);
+   erase(0, size);
+//   std::cout &lt;&lt; &quot;readString:&quot; &lt;&lt; value &lt;&lt; std::endl;
+}
+
+
+void CBinString::readBool(bool &amp;value)
+{
+   char byte;
+   byte = (*this)[0];
+   erase(0,1);
+   value=byte;
+//   std::cout &lt;&lt; &quot;readBool:&quot; &lt;&lt; value &lt;&lt; std::endl;
+}
+
+
+bool CBinString::removeIfEqual(const int &amp;value)
+{
+   // TODO: nao ta correto pq sempre retira...
+   int data;
+   readInt(data);
+   return value == data;
+}
+
+
+bool CBinString::removeIfEqual(const char &amp;value)
+{
+   // TODO: nao ta correto pq sempre retira...
+   char data;
+   readByte(data);
+   return value == data;
+}
+
+
+bool CBinString::removeIfEqual(const std::string &amp;value)
+{
+   // TODO: nao ta correto pq sempre retira...
+   std::string data;
+   readString(data);
+   return value == data;
+}
+

Added: trunk/gpt2/common/src/CBinString.hpp
===================================================================
--- trunk/gpt2/common/src/CBinString.hpp	2007-11-19 03:48:19 UTC (rev 373)
+++ trunk/gpt2/common/src/CBinString.hpp	2007-11-19 19:53:34 UTC (rev 374)
@@ -0,0 +1,23 @@
+#ifndef GPT_BIN_STRING_H
+#define GPT_BIN_STRING_H
+
+#include &lt;string&gt;
+
+
+class CBinString : public std::string
+{
+public:
+   void writeInt(const int &amp;value);
+   void writeByte(const char &amp;value);
+   void writeString(const std::string &amp;value, const bool &amp;writeSize=true);
+   void writeBool(const bool &amp;value);
+   void readInt(int &amp;value);
+   void readByte(char &amp;value);
+   void readString(std::string &amp;value);
+   void readBool(bool &amp;value);
+   bool removeIfEqual(const int &amp;value);
+   bool removeIfEqual(const char &amp;value);
+   bool removeIfEqual(const std::string &amp;value);
+};
+
+#endif

Added: trunk/gpt2/common/src/CCode.cpp
===================================================================
--- trunk/gpt2/common/src/CCode.cpp	2007-11-19 03:48:19 UTC (rev 373)
+++ trunk/gpt2/common/src/CCode.cpp	2007-11-19 19:53:34 UTC (rev 374)
@@ -0,0 +1,61 @@
+#include &quot;CCode.hpp&quot;
+
+
+CCode::CCode()
+{
+}
+
+
+CCode::~CCode()
+{
+}
+
+
+void CCode::addByte(const char &amp;code)
+{
+   _data += code;
+}
+
+
+void CCode::addInt(const int &amp;code)
+{
+   const char *byte = (const char*) &code;
+
+   for (size_t i = 0; i &lt; sizeof(int); i++) {
+      _data += *byte;
+      byte++;
+   }
+}
+
+
+int CCode::size() const
+{
+   return _data.size();
+}
+
+
+CBinString CCode::getBinary() const
+{
+   return _data;
+}
+
+
+bool CCode::readFromBinary(CBinString &amp;bin)
+{
+   bin.readString(_data);
+   return true;
+}
+
+
+char CCode::getByte(const int &amp;pos)
+{
+   return _data[pos];
+}
+
+
+int CCode::getInt(const int &amp;pos)
+{
+   int *ret = (int*)&amp;(_data[pos]);
+   return *ret;
+}
+

Added: trunk/gpt2/common/src/CCode.hpp
===================================================================
--- trunk/gpt2/common/src/CCode.hpp	2007-11-19 03:48:19 UTC (rev 373)
+++ trunk/gpt2/common/src/CCode.hpp	2007-11-19 19:53:34 UTC (rev 374)
@@ -0,0 +1,27 @@
+#ifndef GPT_CODE_H
+#define GPT_CODE_H
+
+
+#include &lt;string&gt;
+
+#include &quot;CBinString.hpp&quot;
+
+
+class CCode
+{
+public:
+   CCode();
+   ~CCode();
+   void addByte(const char &amp;code);
+   void addInt(const int &amp;code);
+   int size() const;
+   CBinString getBinary() const;
+   bool readFromBinary(CBinString &amp;bin);
+   char getByte(const int &amp;pos);
+   int getInt(const int &amp;pos);
+private:
+   CBinString _data;
+};
+
+#endif
+

Added: trunk/gpt2/common/src/CData.cpp
===================================================================
--- trunk/gpt2/common/src/CData.cpp	2007-11-19 03:48:19 UTC (rev 373)
+++ trunk/gpt2/common/src/CData.cpp	2007-11-19 19:53:34 UTC (rev 374)
@@ -0,0 +1,95 @@
+#include &quot;CData.hpp&quot;
+
+
+CData::CData()
+{
+}
+
+
+CData::~CData()
+{
+}
+
+
+CSymbol* CData::add(CSymbol *symbol)
+{
+//   std::cout &lt;&lt; &quot;Adicionando [&quot; &lt;&lt; symbol-&gt;getName() &lt;&lt; &quot;] type [&quot; &lt;&lt; symbol-&gt;getType() &lt;&lt; &quot;] address [&quot; &lt;&lt; symbol-&gt;getAddress() &lt;&lt; &quot;] a Data&quot; &lt;&lt; std::endl;
+
+   return CSymbolList::add( symbol );
+}
+
+
+//CSymbol* CData::add(const std::string &amp;name, const int &amp;category, const int &amp;type, const int &amp;address)
+//{
+//   return CSymbolList::add( name, category, type, address, 0 ); // TODO: nao eh zero...
+//}
+
+
+CSymbol* CData::addVariable (const std::string &amp;name, const int &amp;type, const int &amp;address)
+{
+   CSymbol *symbol = new CSymbol (name, type, CSymbol::VAR, address);
+
+   _symbols.push_back(symbol);
+
+   //_data += symbol-&gt;getBinary();
+   for (int i=0; i &lt; symbol-&gt;getTypeSize(); i++) {
+      // TODO: horrivel :-)
+      _data.writeByte (' ');
+   }
+
+   return symbol;
+}
+
+
+CSymbol* CData::addConstant (const std::string &amp;name, const int &amp;type, const int &amp;address)
+{
+   CSymbol *symbol = new CSymbol (name, type, CSymbol::CONST, address);
+
+   _symbols.push_back(symbol);
+
+   //_data += symbol-&gt;getBinary();
+   if (type == CSymbol::STRING) {
+      _data.writeString(name, false);
+   } else if (type == CSymbol::INT) {
+      _data.writeInt(atoi(name.c_str()));
+   }
+
+   return symbol;
+}
+
+
+bool CData::readFromBinary(CBinString &amp;bin)
+{
+   bin.readString(_data);
+   return true;
+}
+
+
+std::string CData::getString(const int &amp;address)
+{
+   int pos = 0;
+
+   pos = _data.find('\0', address);
+
+   if (pos == -1) {
+      abort();
+   }
+
+   return _data.substr(address, pos - address);
+}
+
+
+int CData::getInt(const int &amp;address)
+{
+   int *ret = (int*)&amp;(_data[address]);
+   return *ret;
+}
+
+
+void CData::setInt(const int &amp;address, const int &amp;value)
+{
+   int *targetAddress = (int*)&amp;(_data[address]);
+
+   *targetAddress = value;
+}
+

Added: trunk/gpt2/common/src/CData.hpp
===================================================================
--- trunk/gpt2/common/src/CData.hpp	2007-11-19 03:48:19 UTC (rev 373)
+++ trunk/gpt2/common/src/CData.hpp	2007-11-19 19:53:34 UTC (rev 374)
@@ -0,0 +1,25 @@
+#ifndef GPT_DATA_H
+#define GPT_DATA_H
+
+#include &lt;string&gt;
+#include &lt;map&gt;
+
+#include &quot;CSymbolList.hpp&quot;
+
+
+class CData : public CSymbolList
+{
+public:
+   CData();
+   ~CData();
+   CSymbol* add(CSymbol *symbol);
+   CSymbol* addVariable (const std::string &amp;name, const int &amp;type, const int &amp;address);
+   CSymbol* addConstant (const std::string &amp;name, const int &amp;type, const int &amp;address);
+   bool readFromBinary(CBinString &amp;bin);
+   std::string getString(const int &amp;address);
+   int getInt(const int &amp;address);
+   void setInt(const int &amp;address, const int &amp;value);
+};
+
+#endif
+

Added: trunk/gpt2/common/src/CHeader.cpp
===================================================================
--- trunk/gpt2/common/src/CHeader.cpp	2007-11-19 03:48:19 UTC (rev 373)
+++ trunk/gpt2/common/src/CHeader.cpp	2007-11-19 19:53:34 UTC (rev 374)
@@ -0,0 +1,38 @@
+#include &quot;CHeader.hpp&quot;
+
+
+CHeader::CHeader()
+{
+   const std::string versionStr = &quot;GVM version 0.1&quot;;
+   _data.writeInt(0x1234);
+   _data.writeString(versionStr);
+   _data.writeByte(0);
+   _data.writeByte(1);
+}
+
+
+CHeader::~CHeader()
+{
+}
+
+
+CBinString CHeader::getBinary()
+{
+   return _data;
+}
+
+
+bool CHeader::readFromBinary(CBinString &amp;bin)
+{
+   bool result = bin.removeIfEqual(0x1234) &amp;&amp;
+                 bin.removeIfEqual(&quot;GVM version 0.1&quot;) &amp;&amp;
+                 bin.removeIfEqual((char)0) &amp;&amp;
+                 bin.removeIfEqual((char)1);
+
+   if (result == false) {
+      return false;
+   }
+
+   return true;
+}
+

Added: trunk/gpt2/common/src/CHeader.hpp
===================================================================
--- trunk/gpt2/common/src/CHeader.hpp	2007-11-19 03:48:19 UTC (rev 373)
+++ trunk/gpt2/common/src/CHeader.hpp	2007-11-19 19:53:34 UTC (rev 374)
@@ -0,0 +1,21 @@
+#ifndef GPT_HEADER_H
+#define GPT_HEADER_H
+
+#include &lt;string&gt;
+
+#include &quot;CBinString.hpp&quot;
+
+
+class CHeader
+{
+public:
+   CHeader();
+   ~CHeader();
+   CBinString getBinary();
+   bool readFromBinary(CBinString &amp;bin);
+private:
+   CBinString _data;
+};
+
+#endif
+

Added: trunk/gpt2/common/src/COptions.hpp
===================================================================
--- trunk/gpt2/common/src/COptions.hpp	2007-11-19 03:48:19 UTC (rev 373)
+++ trunk/gpt2/common/src/COptions.hpp	2007-11-19 19:53:34 UTC (rev 374)
@@ -0,0 +1,22 @@
+#ifndef GPT_OPTIONS_HPP
+#define GPT_OPTIONS_HPP
+
+
+#include &lt;string&gt;
+using namespace std;
+
+
+class COptions {
+public:
+   COptions( ) {
+//      sentences = false;
+//      sourceLine = NULL;
+   }
+   std::string sourcefile;
+   std::string destfile;
+//   bool sentences;
+//   int *sourceLine;
+};
+
+#endif
+

Added: trunk/gpt2/common/src/CSymbol.cpp
===================================================================
--- trunk/gpt2/common/src/CSymbol.cpp	2007-11-19 03:48:19 UTC (rev 373)
+++ trunk/gpt2/common/src/CSymbol.cpp	2007-11-19 19:53:34 UTC (rev 374)
@@ -0,0 +1,78 @@
+#include &lt;iostream&gt;
+
+
+#include &quot;CSymbol.hpp&quot;
+
+
+CSymbol::CSymbol()
+{
+}
+
+
+CSymbol::CSymbol (const std::string &amp;name, const char &amp;type, const char &amp;category, const int &amp;address)
+   : _name(name)
+   , _type(type)
+   , _category(category)
+   , _address(address)
+{
+}
+
+
+CSymbol::CSymbol (const std::string &amp;name, const char &amp;type, 
+                  const int &amp;address, const bool &amp;hasVarArguments, 
+                  const int &amp;staticParameters, 
+                  std::vector&lt;CSymbol&gt; parameters)
+   : _name(name)
+   , _type(type)
+   , _category(CSymbol::PROC)
+   , _address(address)
+   , _hasVarArguments(hasVarArguments)
+   , _staticParameters(staticParameters)
+   , _parameters(parameters)
+{
+}
+
+
+CSymbol::~CSymbol()
+{
+}
+
+
+int CSymbol::getTypeSize() const
+{
+   switch(_type) {
+   case INT:
+   case CHAR:
+   case BOOL:
+      return sizeof(int);
+   case REAL:
+      return sizeof(double);
+   case STRING:
+   case MATRIX:
+      return sizeof(void*);
+   }
+   return 0;
+}
+
+
+bool CSymbol::readFromBinary(CBinString &amp;bin)
+{
+   bin.readInt(_address);
+   bin.readByte(_category);
+
+   if (_category == CSymbol::VAR || _category == CSymbol::CONST) {
+      bin.readByte(_type);
+      bin.readString(_name);
+//      std::cout &lt;&lt; &quot;var ou const, type=&quot; &lt;&lt; _type &lt;&lt; &quot; name=&quot; &lt;&lt; _name &lt;&lt; std::endl;
+   } else { // PROC
+      bool _hasVariableArguments;// TODO
+      char _staticParameters;// TODO
+      bin.readByte(_type);
+      bin.readString(_name);
+      bin.readBool(_hasVariableArguments);
+      bin.readByte(_staticParameters);
+//      std::cout &lt;&lt; &quot;proc, type=&quot; &lt;&lt; _type &lt;&lt; &quot; name=&quot; &lt;&lt; _name &lt;&lt; std::endl;
+   }
+   return true;
+}
+

Added: trunk/gpt2/common/src/CSymbol.hpp
===================================================================
--- trunk/gpt2/common/src/CSymbol.hpp	2007-11-19 03:48:19 UTC (rev 373)
+++ trunk/gpt2/common/src/CSymbol.hpp	2007-11-19 19:53:34 UTC (rev 374)
@@ -0,0 +1,81 @@
+#ifndef GPT_SYMBOL_HPP
+#define GPT_SYMBOL_HPP
+
+#include &lt;vector&gt;
+
+#include &quot;CBinString.hpp&quot;
+
+
+class CSymbol
+{
+public:
+   enum ECategory {
+      PROC = 'P',
+      CONST = 'C',
+      VAR = 'V',
+      PARAM = 'P'
+   };
+   enum EType {
+      NO_TYPE = 'N',
+      STRING = 'S',
+      INT = 'I',
+      CHAR = 'C',
+      BOOL = 'B',
+      REAL = 'R',
+      MATRIX = 'M'
+   };
+   CSymbol ();
+   CSymbol (const std::string &amp;name, const char &amp;type, const char &amp;category,
+            const int &amp;address);
+   CSymbol (const std::string &amp;name, const char &amp;type, const int &amp;address,
+            const bool &amp;hasVarArguments, const int &amp;staticParameters,
+            std::vector&lt;CSymbol&gt; parameters);
+   virtual ~CSymbol();
+   std::string getName() const
+   {
+      return _name;
+   }
+   CBinString getBinary() const
+   {
+      return _data;
+   }
+   int getTypeSize() const;
+   char getType() const
+   {
+      return _type;
+   }
+   char getCategory() const
+   {
+      return _category; 
+   }
+   int getAddress() const
+   {
+      return _address;
+   }
+   bool readFromBinary(CBinString &amp;bin);
+   bool getHasVarArguments() const
+   {
+      return _hasVarArguments;
+   }
+   int getStaticParameters() const
+   {
+      return _staticParameters;
+   }
+   std::vector&lt;CSymbol&gt; getParameters() const
+   {
+      return _parameters;
+   }
+protected:
+   CBinString           _data;
+private:
+   std::string          _name;
+   char                 _type;
+   char                 _category;
+   int                  _address;
+   bool                 _hasVarArguments;
+   int                  _staticParameters;
+   std::vector&lt;CSymbol&gt; _parameters;
+};
+
+#endif
+

Added: trunk/gpt2/common/src/CSymbolList.cpp
===================================================================
--- trunk/gpt2/common/src/CSymbolList.cpp	2007-11-19 03:48:19 UTC (rev 373)
+++ trunk/gpt2/common/src/CSymbolList.cpp	2007-11-19 19:53:34 UTC (rev 374)
@@ -0,0 +1,83 @@
+#include &quot;CSymbolList.hpp&quot;
+
+
+CSymbolList::CSymbolList() //: _size(0)
+{
+}
+
+
+CSymbolList::~CSymbolList()
+{
+}
+
+
+CSymbol* CSymbolList::add(CSymbol* symbol)
+{
+   _symbols.push_back(symbol);
+
+   _data += symbol-&gt;getBinary();
+   return symbol;
+}
+
+
+CSymbol* CSymbolList::getSymbol(const std::string &amp;name)
+{
+   std::vector&lt;CSymbol*&gt;::iterator it;
+
+   it = find(name);
+
+   return *it;
+}
+
+
+int CSymbolList::getReference( const std::string &amp;name )
+{
+   std::vector&lt;CSymbol*&gt;::iterator it;
+
+   it = find(name);
+
+   if (it == _symbols.end()) {
+      return -1;
+   }
+
+   return (it - _symbols.begin());
+}
+
+
+int CSymbolList::getAddress( const std::string &amp;name )
+{
+   std::vector&lt;CSymbol*&gt;::iterator it;
+
+   it = find(name);
+
+   if (it == _symbols.end()) {
+      return -1;
+   }
+
+   return (*it)-&gt;getAddress();
+}
+
+
+std::vector&lt;CSymbol*&gt;::iterator CSymbolList::find(const std::string &amp;name)
+{
+   for(std::vector&lt;CSymbol*&gt;::iterator it = _symbols.begin(); it != _symbols.end(); it++) {
+      if ((*it)-&gt;getName() == name) {
+         return it;
+      }
+   }
+
+   return _symbols.end();
+}
+
+
+bool CSymbolList::readFromBinary(CBinString &amp;bin)
+{
+   int size = 0;
+   bin.readInt(size);
+   for (int count=0; count &lt; size; count++) {
+      CSymbol *symbol = new CSymbol();
+      symbol-&gt;readFromBinary(bin);
+      add(symbol);
+   }
+   return true;
+}

Added: trunk/gpt2/common/src/CSymbolList.hpp
===================================================================
--- trunk/gpt2/common/src/CSymbolList.hpp	2007-11-19 03:48:19 UTC (rev 373)
+++ trunk/gpt2/common/src/CSymbolList.hpp	2007-11-19 19:53:34 UTC (rev 374)
@@ -0,0 +1,43 @@
+#ifndef GPT_SYMBOL_LIST_H
+#define GPT_SYMBOL_LIST_H
+
+#include &lt;string&gt;
+#include &lt;vector&gt;
+#include &lt;iostream&gt;
+
+#include &lt;stdlib.h&gt;
+
+#include &quot;CSymbol.hpp&quot;
+
+
+class CSymbolList
+{
+public:
+   CSymbolList();
+   virtual ~CSymbolList();
+   CSymbol* add(CSymbol* symbol);
+   int getReference(const std::string &amp;name);
+   int getAddress( const std::string &amp;name );
+   CSymbol* getSymbol(const std::string &amp;name);
+   std::vector&lt;CSymbol*&gt;::iterator find(const std::string &amp;name);
+   CBinString getBinary() const
+   {
+      return _data;
+   }
+   int getDataSize() const
+   {
+      return _data.size();
+   }
+   int getSymbolsCount() const
+   {
+      return _symbols.size();
+   }
+   bool readFromBinary(CBinString &amp;bin);
+protected:
+   std::vector&lt;CSymbol*&gt; _symbols;
+   CBinString _data;
+private:
+};
+
+#endif
+

Added: trunk/gpt2/common/src/CSymbolTable.cpp
===================================================================
--- trunk/gpt2/common/src/CSymbolTable.cpp	2007-11-19 03:48:19 UTC (rev 373)
+++ trunk/gpt2/common/src/CSymbolTable.cpp	2007-11-19 19:53:34 UTC (rev 374)
@@ -0,0 +1,83 @@
+#include &quot;CSymbolTable.hpp&quot;
+
+
+CSymbolTable::CSymbolTable()
+{
+}
+
+
+CSymbolTable::~CSymbolTable()
+{
+}
+
+
+CSymbol* CSymbolTable::addProcedure (const std::string &amp;name, const int &amp;type, const int &amp;address, const bool &amp;hasVarArguments, const int &amp;staticParameters, std::vector&lt;CSymbol&gt; parameters)
+{
+   CSymbol *symbol = new CSymbol( name, type, address, hasVarArguments, staticParameters, parameters);
+
+   _symbols.push_back(symbol);
+
+   // Endere&#231;o 0123 (code), procedure, sem retorno, nome &quot;p1&quot;,
+   // sem argumentos vari&#225;veis, 2 par&#226;metros fixos, p1 (int) e p2 (string)
+   // 0024: 0123 P N 2 &quot;p1&quot; N 2 I 4 2 &quot;p1&quot; S 30 2 &quot;p2&quot;
+   _data.writeInt( address );
+   _data.writeByte( CSymbol::PROC ); // procedure
+   _data.writeByte( type ); // tipo do retorno // TODO: em asm proc tem retorno ???
+   _data.writeString( name ); // nome da procedure
+   _data.writeBool( hasVarArguments );
+   _data.writeByte( staticParameters );
+   // TODO: falta argumentos
+
+   return symbol;
+}
+
+
+CSymbol* CSymbolTable::addParameter (const std::string &amp;name, const int &amp;type, const int &amp;address)
+{
+   CSymbol *symbol = new CSymbol( name, type, CSymbol::PARAM, address);
+
+   _symbols.push_back(symbol);
+
+   //_data += symbol-&gt;getBinary();
+
+   return symbol;
+}
+
+
+CSymbol* CSymbolTable::addConstant (const std::string &amp;name, const int &amp;type, const int &amp;address)
+{
+   CSymbol *symbol = new CSymbol( name, type, CSymbol::CONST, address);
+
+   _symbols.push_back(symbol);
+
+   // Endere&#231;o 0000 (data), constante, string, 8 bytes ???, nome &quot;c1&quot;
+   // 0000: 0000 C S 8??? 2 &quot;c1&quot;
+   _data.writeInt( address );
+   _data.writeByte( CSymbol::CONST ); // categoria: constante
+   _data.writeByte( type );           // tipo
+   _data.writeString( name );         // nome da constante
+
+   return symbol;
+}
+
+
+CSymbol* CSymbolTable::add(CSymbol *symbol)
+{
+//   std::cout &lt;&lt; &quot;Adicionando simbolo [&quot; &lt;&lt; symbol-&gt;getName() &lt;&lt; &quot;] type [&quot; &lt;&lt; symbol-&gt;getType() &lt;&lt; &quot;] address [&quot; &lt;&lt; symbol-&gt;getAddress() &lt;&lt; &quot;] a SymbolTable&quot; &lt;&lt; std::endl;
+
+   return CSymbolList::add( symbol );
+}
+
+
+bool CSymbolTable::readFromBinary(CBinString &amp;bin)
+{
+   int size;
+   bin.readInt(size);
+   for (int count=0; count &lt; size; count++) {
+      CSymbol *symbol = new CSymbol();
+      symbol-&gt;readFromBinary(bin);
+      add(symbol);
+   }
+   return true;
+}
+

Added: trunk/gpt2/common/src/CSymbolTable.hpp
===================================================================
--- trunk/gpt2/common/src/CSymbolTable.hpp	2007-11-19 03:48:19 UTC (rev 373)
+++ trunk/gpt2/common/src/CSymbolTable.hpp	2007-11-19 19:53:34 UTC (rev 374)
@@ -0,0 +1,24 @@
+#ifndef GPT_SYMBOL_TABLE_H
+#define GPT_SYMBOL_TABLE_H
+
+#include &lt;string&gt;
+#include &lt;map&gt;
+
+
+#include &quot;CSymbolList.hpp&quot;
+
+
+class CSymbolTable : public CSymbolList
+{
+public:
+   CSymbolTable();
+   ~CSymbolTable();
+   CSymbol* addProcedure (const std::string &amp;name, const int &amp;type, const int &amp;address, const bool &amp;hasVarArguments, const int &amp;staticParameters, std::vector&lt;CSymbol&gt; parameters);
+   CSymbol* addParameter (const std::string &amp;name, const int &amp;type, const int &amp;address);
+   CSymbol* addConstant (const std::string &amp;name, const int &amp;type, const int &amp;address);
+   CSymbol* add(CSymbol *symbol);
+   bool readFromBinary(CBinString &amp;bin);
+};
+
+#endif
+

Added: trunk/gpt2/common/src/Common.hpp
===================================================================
--- trunk/gpt2/common/src/Common.hpp	2007-11-19 03:48:19 UTC (rev 373)
+++ trunk/gpt2/common/src/Common.hpp	2007-11-19 19:53:34 UTC (rev 374)
@@ -0,0 +1,116 @@
+#ifndef GPT_COMMON
+#define GPT_COMMON
+
+enum opcode {
+   OP_NOP         = 0,
+   OP_HLT         = 1,
+   OP_EXIT        = 2,
+   OP_ISUM        = 3,
+   OP_SSUM        = 4,
+   OP_RSUM        = 5,
+   OP_ISUB        = 6,
+   OP_SSUB        = 7,
+   OP_RSUB        = 8,
+   OP_IMUL        = 9,
+   OP_RMUL        = 10,
+   OP_IDIV        = 11,
+   OP_RDIV        = 12,
+   OP_IMOD        = 13,
+   OP_RMOD        = 14,
+   OP_IGE         = 15,
+   OP_SGE         = 16,
+   OP_RGE         = 17,
+   OP_ILE         = 18,
+   OP_SLE         = 19,
+   OP_RLE         = 20,
+   OP_INE         = 21,
+   OP_SNE         = 22,
+   OP_RNE         = 23,
+   OP_IGT         = 24,
+   OP_SGT         = 25,
+   OP_RGT         = 26,
+   OP_ILT         = 27,
+   OP_SLT         = 28,
+   OP_RLT         = 29,
+   OP_IEQ         = 30,
+   OP_SEQ         = 31,
+   OP_REQ         = 32,
+   OP_OR = 33,
+   OP_AND         = 34,
+   OP_XOR         = 35,
+   OP_INEG = 36,
+   OP_RNEG = 37,
+   OP_NOT         = 38,
+   OP_IINC = 39,
+   OP_IDEC = 40,
+   OP_I2C         = 41,
+   OP_R2C         = 42,
+   OP_S2C         = 43,
+   OP_B2C         = 44,
+   OP_I2R         = 45,
+   OP_C2R         = 46,
+   OP_S2R         = 47,
+   OP_B2R         = 48,
+   OP_I2B         = 49,
+   OP_C2B         = 50,
+   OP_R2B         = 51,
+   OP_S2B         = 52,
+   OP_I2S         = 53,
+   OP_C2S         = 54,
+   OP_R2S         = 55,
+   OP_B2S         = 56,
+   OP_P2S         = 57,
+   OP_C2I         = 58,
+   OP_R2I         = 59,
+   OP_S2I         = 60,
+   OP_B2I         = 61,
+   OP_ISET = 62,
+   OP_SSET = 63,
+   OP_RSET = 64,
+   OP_GETA = 65,
+   OP_IGETV = 66,
+   OP_SGETV = 67,
+   OP_RGETV = 68,
+   OP_ISETV = 69,
+   OP_SSETV = 70,
+   OP_RSETV = 71,
+   OP_JMP         = 72,
+   OP_IF = 73,
+   OP_IFNOT = 74,
+   OP_PUSH = 75,
+   OP_POP         = 76,
+   OP_INCSP = 77,
+   OP_DECSP = 78,
+   OP_PUSH_INT = 79,
+   OP_PUSH_STRING = 80,
+   OP_PUSH_REAL = 81,
+   OP_PUSH_CHAR = 82,
+   OP_PUSH_BOOL = 83,
+   OP_PUSH_MATRIX = 84,
+   OP_PUSH_SP = 85,
+   OP_POP_SP = 86,
+   OP_INCSP_4 = 87,
+   OP_INCSP_8 = 88,
+   OP_DECSP_4 = 89,
+   OP_DECSP_8 = 90,
+   OP_PCALL = 91,
+   OP_RET         = 92,
+   OP_SALLOC = 93,
+   OP_SFREE = 94,
+   OP_SSETC = 95,
+   OP_SGETC = 96,
+   OP_M1ALLOC = 97,
+   OP_M2ALLOC = 98,
+   OP_MFREE = 99,
+   OP_M1SET = 100,
+   OP_M1GET = 101,
+   OP_M2SET = 102,
+   OP_M2GET = 103,
+   OP_MCOPY = 104,
+   OP_MGETSIZE1 = 105,
+   OP_MGETSIZE2 = 106,
+   OPCODE_NUMBER  = 107 // TODO: Isso nao eh seguro...
+};
+
+#endif
+

Added: trunk/gpt2/gptasm/src/CGenBytecode.cpp
===================================================================
--- trunk/gpt2/gptasm/src/CGenBytecode.cpp	2007-11-19 03:48:19 UTC (rev 373)
+++ trunk/gpt2/gptasm/src/CGenBytecode.cpp	2007-11-19 19:53:34 UTC (rev 374)
@@ -0,0 +1,228 @@
+#include &quot;CGenBytecode.hpp&quot;
+
+#include &lt;sstream&gt;
+#include &lt;iostream&gt;
+
+
+#include &quot;Common.hpp&quot;
+
+
+CGenBytecode::CGenBytecode()
+{
+   _opcodes[ &quot;isum&quot;        ] = OP_ISUM;
+   _opcodes[ &quot;ssum&quot;        ] = OP_SSUM;
+   _opcodes[ &quot;rsum&quot;        ] = OP_RSUM;
+   _opcodes[ &quot;isub&quot;        ] = OP_ISUB;
+   _opcodes[ &quot;ssub&quot;        ] = OP_SSUB;
+   _opcodes[ &quot;rsub&quot;        ] = OP_RSUB;
+   _opcodes[ &quot;imul&quot;        ] = OP_IMUL;
+   _opcodes[ &quot;rmul&quot;        ] = OP_RMUL;
+   _opcodes[ &quot;idiv&quot;        ] = OP_IDIV;
+   _opcodes[ &quot;rdiv&quot;        ] = OP_RDIV;
+   _opcodes[ &quot;imod&quot;        ] = OP_IMOD;
+   _opcodes[ &quot;rmod&quot;        ] = OP_RMOD;
+   _opcodes[ &quot;ige&quot;         ] = OP_IGE;
+   _opcodes[ &quot;sge&quot;         ] = OP_SGE;
+   _opcodes[ &quot;rge&quot;         ] = OP_RGE;
+   _opcodes[ &quot;ile&quot;         ] = OP_ILE;
+   _opcodes[ &quot;sle&quot;         ] = OP_SLE;
+   _opcodes[ &quot;rle&quot;         ] = OP_RLE;
+   _opcodes[ &quot;ine&quot;         ] = OP_INE;
+   _opcodes[ &quot;sne&quot;         ] = OP_SNE;
+   _opcodes[ &quot;rne&quot;         ] = OP_RNE;
+   _opcodes[ &quot;igt&quot;         ] = OP_IGT;
+   _opcodes[ &quot;sgt&quot;         ] = OP_SGT;
+   _opcodes[ &quot;rgt&quot;         ] = OP_RGT;
+   _opcodes[ &quot;ilt&quot;         ] = OP_ILT;
+   _opcodes[ &quot;slt&quot;         ] = OP_SLT;
+   _opcodes[ &quot;rlt&quot;         ] = OP_RLT;
+   _opcodes[ &quot;ieq&quot;         ] = OP_IEQ;
+   _opcodes[ &quot;seq&quot;         ] = OP_SEQ;
+   _opcodes[ &quot;req&quot;         ] = OP_REQ;
+   _opcodes[ &quot;or&quot;          ] = OP_OR;
+   _opcodes[ &quot;and&quot;         ] = OP_AND;
+   _opcodes[ &quot;xor&quot;         ] = OP_XOR;
+   _opcodes[ &quot;ineg&quot;        ] = OP_INEG;
+   _opcodes[ &quot;rneg&quot;        ] = OP_RNEG;
+   _opcodes[ &quot;not&quot;         ] = OP_NOT;
+   _opcodes[ &quot;iinc&quot;        ] = OP_IINC;
+   _opcodes[ &quot;idec&quot;        ] = OP_IDEC;
+   _opcodes[ &quot;i2c&quot;         ] = OP_I2C;
+   _opcodes[ &quot;r2c&quot;         ] = OP_R2C;
+   _opcodes[ &quot;s2c&quot;         ] = OP_S2C;
+   _opcodes[ &quot;b2c&quot;         ] = OP_B2C;
+   _opcodes[ &quot;i2r&quot;         ] = OP_I2R;
+   _opcodes[ &quot;c2r&quot;         ] = OP_C2R;
+   _opcodes[ &quot;s2r&quot;         ] = OP_S2R;
+   _opcodes[ &quot;b2r&quot;         ] = OP_B2R;
+   _opcodes[ &quot;i2b&quot;         ] = OP_I2B;
+   _opcodes[ &quot;c2b&quot;         ] = OP_C2B;
+   _opcodes[ &quot;r2b&quot;         ] = OP_R2B;
+   _opcodes[ &quot;s2b&quot;         ] = OP_S2B;
+   _opcodes[ &quot;i2s&quot;         ] = OP_I2S;
+   _opcodes[ &quot;c2s&quot;         ] = OP_C2S;
+   _opcodes[ &quot;r2s&quot;         ] = OP_R2S;
+   _opcodes[ &quot;b2s&quot;         ] = OP_B2S;
+   _opcodes[ &quot;p2s&quot;         ] = OP_P2S;
+   _opcodes[ &quot;c2i&quot;         ] = OP_C2I;
+   _opcodes[ &quot;r2i&quot;         ] = OP_R2I;
+   _opcodes[ &quot;s2i&quot;         ] = OP_S2I;
+   _opcodes[ &quot;b2i&quot;         ] = OP_B2I;
+   _opcodes[ &quot;iset&quot;        ] = OP_ISET;
+   _opcodes[ &quot;sset&quot;        ] = OP_SSET;
+   _opcodes[ &quot;rset&quot;        ] = OP_RSET;
+   _opcodes[ &quot;geta&quot;        ] = OP_GETA;
+   _opcodes[ &quot;igetv&quot;       ] = OP_IGETV;
+   _opcodes[ &quot;sgetv&quot;       ] = OP_SGETV;
+   _opcodes[ &quot;rgetv&quot;       ] = OP_RGETV;
+   _opcodes[ &quot;isetv&quot;       ] = OP_ISETV;
+   _opcodes[ &quot;ssetv&quot;       ] = OP_SSETV;
+   _opcodes[ &quot;rsetv&quot;       ] = OP_RSETV;
+   _opcodes[ &quot;jmp&quot;         ] = OP_JMP;
+   _opcodes[ &quot;if&quot;          ] = OP_IF;
+   _opcodes[ &quot;ifnot&quot;       ] = OP_IFNOT;
+   _opcodes[ &quot;push&quot;        ] = OP_PUSH;
+   _opcodes[ &quot;pop&quot;         ] = OP_POP;
+   _opcodes[ &quot;incsp&quot;       ] = OP_INCSP;
+   _opcodes[ &quot;decsp&quot;       ] = OP_DECSP;
+//   _opcodes[ &quot;push_0&quot;      ] = OP_PUSH_0;
+//   _opcodes[ &quot;push_1&quot;      ] = OP_PUSH_1;
+//   _opcodes[ &quot;push_2&quot;      ] = OP_PUSH_2;
+//   _opcodes[ &quot;push_3&quot;      ] = OP_PUSH_3;
+//   _opcodes[ &quot;push_4&quot;      ] = OP_PUSH_4;
+//   _opcodes[ &quot;push_5&quot;      ] = OP_PUSH_5;
+   _opcodes[ &quot;push_int&quot;    ] = OP_PUSH_INT;
+   _opcodes[ &quot;push_string&quot; ] = OP_PUSH_STRING;
+   _opcodes[ &quot;push_real&quot;   ] = OP_PUSH_REAL;
+   _opcodes[ &quot;push_char&quot;   ] = OP_PUSH_CHAR;
+   _opcodes[ &quot;push_bool&quot;   ] = OP_PUSH_BOOL;
+   _opcodes[ &quot;push_matrix&quot; ] = OP_PUSH_MATRIX;
+   _opcodes[ &quot;push_sp&quot;     ] = OP_PUSH_SP;
+   _opcodes[ &quot;pop_sp&quot;      ] = OP_POP_SP;
+   _opcodes[ &quot;incsp_4&quot;     ] = OP_INCSP_4;
+   _opcodes[ &quot;incsp_8&quot;     ] = OP_INCSP_8;
+   _opcodes[ &quot;decsp_4&quot;     ] = OP_DECSP_4;
+   _opcodes[ &quot;decsp_8&quot;     ] = OP_DECSP_8;
+   _opcodes[ &quot;pcall&quot;       ] = OP_PCALL;
+   _opcodes[ &quot;ret&quot;         ] = OP_RET;
+   _opcodes[ &quot;salloc&quot;      ] = OP_SALLOC;
+   _opcodes[ &quot;sfree&quot;       ] = OP_SFREE;
+   _opcodes[ &quot;ssetc&quot;       ] = OP_SSETC;
+   _opcodes[ &quot;sgetc&quot;       ] = OP_SGETC;
+   _opcodes[ &quot;m1alloc&quot;     ] = OP_M1ALLOC;
+   _opcodes[ &quot;m2alloc&quot;     ] = OP_M2ALLOC;
+   _opcodes[ &quot;mfree&quot;       ] = OP_MFREE;
+   _opcodes[ &quot;m1set&quot;       ] = OP_M1SET;
+   _opcodes[ &quot;m1get&quot;       ] = OP_M1GET;
+   _opcodes[ &quot;m2set&quot;       ] = OP_M2SET;
+   _opcodes[ &quot;m2get&quot;       ] = OP_M2GET;
+   _opcodes[ &quot;mcopy&quot;       ] = OP_MCOPY;
+   _opcodes[ &quot;mgetsize1&quot;   ] = OP_MGETSIZE1;
+   _opcodes[ &quot;mgetsize2&quot;   ] = OP_MGETSIZE2;
+   _opcodes[ &quot;nop&quot;         ] = OP_NOP;
+//   _opcodes[ &quot;exit_0&quot;      ] = OP_EXIT_0;
+//   _opcodes[ &quot;exit_1&quot;      ] = OP_EXIT_1;
+   _opcodes[ &quot;hlt&quot;         ] = OP_HLT;
+   _opcodes[ &quot;exit&quot;        ] = OP_EXIT;
+}
+
+
+CGenBytecode::~CGenBytecode()
+{
+}
+
+
+void CGenBytecode::initProcedure(const std::string &amp;procedureName, const bool &amp;hasVarArguments, const int &amp;staticParameters, std::vector&lt;CSymbol&gt; parameters)
+{
+// TODO: e qdo procedure vai retornar valor no assembly ???
+// Talvez temos q fazer como em C e gerar procedure_name + retorno + parametros (int_procedure_int_real)
+   _symbolTable.addProcedure (procedureName, CSymbol::NO_TYPE, _code.size(), hasVarArguments, staticParameters, parameters);
+   _currentProcedure = procedureName;
+}
+
+
+void CGenBytecode::finishProcedure()
+{
+   _currentProcedure.clear();
+   // TODO: delete na procedure ???
+}
+
+
+void CGenBytecode::makeVarDefinition(const std::string &amp;lexeme, const int &amp;type)
+{
+//   if (_currentProcedure.empty()) { // assumindo que sao dados globais...
+//      _symbolTable.add(new CVariableDefinition(lexeme, type, _data.getDataSize()));
+//   }
+   _data.addVariable (lexeme, type, _data.getDataSize());
+}
+
+
+void CGenBytecode::makeParDefinition(const std::string &amp;lexeme, const int &amp;type)
+{
+   _symbolTable.addParameter(lexeme, type, 0); // TODO: colocar endereco relativo a SP
+}
+
+
+void CGenBytecode::registryLabel(const std::string &amp;labelName)
+{
+}
+
+
+void CGenBytecode::addOpcode(const std::string &amp;mn)
+{
+//   std::cout &lt;&lt; &quot;Mn=&quot; &lt;&lt; mn &lt;&lt; &quot; opcode: &quot; &lt;&lt; (int)_opcodes[mn] &lt;&lt; std::endl;
+   _code.addByte(_opcodes[mn]);
+}
+
+
+//void CGenBytecode::addIdReference(const std::string &amp;id)
+//{
+//   int ref = _symbolTable.getReference(id);
+//   _code.add(ref);
+//}
+
+
+//void CGenBytecode::addReference(const std::string &amp;id, const int &amp;category, const int &amp;type)
+//{
+//   int ref = _data.getReference(id);
+//   if (ref == -1) {
+//      ref = _data.add(new CConstantData( id, type, _data.size()))-&gt;getAddress();
+//   }
+//   _code.addInt(ref);
+//}
+
+
+void CGenBytecode::addAddress(const std::string &amp;id, const int &amp;category, const int &amp;type)
+{
+   int ref = _data.getAddress(id);
+   if (ref == -1) {
+      //ref = _data.add((new CSymbol())-&gt;setAsConstantData( id, type, _data.getDataSize()))-&gt;getAddress();
+      ref = _data.addConstant (id, type, _data.getDataSize())-&gt;getAddress();
+   }
+   _code.addInt(ref);
+}
+
+
+CBinString CGenBytecode::getBinary()
+{
+//   _header.setSizes(_symbolTable.size(), _data.size(), _code.size());
+
+   CBinString ret;
+
+   ret += _header.getBinary();
+
+//   std::cout &lt;&lt; &quot;symbolTable.getSymbolsCount()=&quot; &lt;&lt; _symbolTable.getSymbolsCount() &lt;&lt; std::endl;
+   ret.writeInt(_symbolTable.getSymbolsCount());
+   ret += _symbolTable.getBinary();
+
+//   std::cout &lt;&lt; &quot;data.size()=&quot; &lt;&lt; _data.getDataSize() &lt;&lt; std::endl;
+   ret.writeInt(_data.getDataSize());
+   ret += _data.getBinary();
+
+//   std::cout &lt;&lt; &quot;code.size()=&quot; &lt;&lt; _code.size() &lt;&lt; std::endl;
+   ret.writeInt(_code.size());
+   ret += _code.getBinary();
+
+   return ret;
+}
+

Added: trunk/gpt2/gptasm/src/CGenBytecode.hpp
===================================================================
--- trunk/gpt2/gptasm/src/CGenBytecode.hpp	2007-11-19 03:48:19 UTC (rev 373)
+++ trunk/gpt2/gptasm/src/CGenBytecode.hpp	2007-11-19 19:53:34 UTC (rev 374)
@@ -0,0 +1,38 @@
+#ifndef GPT_GEN_BYTECODE_H
+#define GPT_GEN_BYTECODE_H
+
+#include &lt;map&gt;
+#include &lt;string&gt;
+#include &lt;vector&gt;
+#include &lt;fstream&gt;
+
+#include &quot;CHeader.hpp&quot;
+#include &quot;CSymbolTable.hpp&quot;
+#include &quot;CData.hpp&quot;
+#include &quot;CCode.hpp&quot;
+#include &quot;CBinString.hpp&quot;
+
+class CGenBytecode
+{
+public:
+   CGenBytecode();
+   ~CGenBytecode();
+   void initProcedure(const std::string &amp;procedureName, const bool &amp;hasVarArguments, const int &amp;staticParameters, std::vector&lt;CSymbol&gt; parameters);
+   void finishProcedure();
+   void makeVarDefinition(const std::string &amp;lexeme, const int &amp;type);
+   void makeParDefinition(const std::string &amp;lexeme, const int &amp;type);
+   void registryLabel(const std::string &amp;labelName);
+   void addOpcode(const std::string &amp;mn);
+   void addAddress(const std::string &amp;id, const int &amp;category, const int &amp;type);
+   CBinString getBinary();
+private:
+   CHeader                    _header;
+   CSymbolTable               _symbolTable;
+   CData                      _data;
+   CCode                      _code;
+   std::map&lt;std::string,char&gt; _opcodes;
+   std::string                _currentProcedure;
+};
+
+#endif
+

Added: trunk/gpt2/gptasm/src/CGptAsm.cpp
===================================================================
--- trunk/gpt2/gptasm/src/CGptAsm.cpp	2007-11-19 03:48:19 UTC (rev 373)
+++ trunk/gpt2/gptasm/src/CGptAsm.cpp	2007-11-19 19:53:34 UTC (rev 374)
@@ -0,0 +1,32 @@
+#include &lt;fstream&gt;
+
+
+#include &quot;CGptAsm.hpp&quot;
+#include &quot;GptAssemblyLexer.hpp&quot;
+#include &quot;GptAssemblyParser.hpp&quot;
+
+
+CGptAsm::CGptAsm( COptions *options ) : _options( options )
+{
+}
+
+
+bool CGptAsm::run( )
+{
+   ifstream in(_options-&gt;sourcefile.c_str());
+   GptAssemblyLexer lexer(in);
+   GptAssemblyParser parser(lexer);
+
+   string asmProgram = parser.program(_options-&gt;sourcefile);
+
+   ofstream asmFile(_options-&gt;destfile.c_str(), ios_base::out);
+   if (!asmFile) {
+      cout &lt;&lt; &quot;ERRO: n&#227;o foi poss&#237;vel abrir o arquivo: \&quot;&quot; &lt;&lt; _options-&gt;destfile &lt;&lt; &quot;\&quot;&quot; &lt;&lt; endl;
+      return false;
+   }
+
+   asmFile &lt;&lt; asmProgram;
+
+   return true;
+}
+

Added: trunk/gpt2/gptasm/src/CGptAsm.hpp
===================================================================
--- trunk/gpt2/gptasm/src/CGptAsm.hpp	2007-11-19 03:48:19 UTC (rev 373)
+++ trunk/gpt2/gptasm/src/CGptAsm.hpp	2007-11-19 19:53:34 UTC (rev 374)
@@ -0,0 +1,16 @@
+#ifndef GPT_CGPTASM_H
+#define GPT_CGPTASM_H
+
+#include &quot;COptions.hpp&quot;
+
+class CGptAsm
+{
+public:
+   CGptAsm( COptions *options );
+   bool run( );
+private:
+   COptions *_options;
+};
+
+#endif
+

Added: trunk/gpt2/gptasm/src/Makefile
===================================================================
--- trunk/gpt2/gptasm/src/Makefile	2007-11-19 03:48:19 UTC (rev 373)
+++ trunk/gpt2/gptasm/src/Makefile	2007-11-19 19:53:34 UTC (rev 374)
@@ -0,0 +1,31 @@
+COMMON_DIR=../../common/src/
+
+INCLUDE_DIR=-I/usr/include/antlr/ -I$(COMMON_DIR)
+CC=g++
+CCFLAGS=-g -Wall
+
+objects = GptAssemblyLexer.o GptAssemblyParser.o main.o CGptAsm.o CGenBytecode.o \
+	$(COMMON_DIR)CSymbol.o $(COMMON_DIR)CSymbolTable.o $(COMMON_DIR)CCode.o $(COMMON_DIR)CHeader.o \
+        $(COMMON_DIR)CData.o $(COMMON_DIR)CBinString.o $(COMMON_DIR)CSymbolList.o
+
+all: $(objects)
+	g++ -o gptasm $(objects) /usr/local/lib/libantlr.a
+
+GptAssemblyLexer.hpp GptAssemblyLexer.cpp: lexer.g
+	antlr lexer.g
+
+GptAssemblyParser.hpp GptAssemblyParser.cpp: parser.g
+	antlr parser.g
+
+
+%.o: %.cpp %.hpp
+	$(CC) $(CCFLAGS) -c $(INCLUDE_DIR) $&lt; -o $@
+
+%.o: %.cpp
+	$(CC) $(CCFLAGS) -c $(INCLUDE_DIR) $&lt; -o $@
+
+
+clean:
+	rm -f *.o $(COMMON_DIR)*.o GptAssemblyLexer.cpp GptAssemblyLexer.hpp GptAssemblyLexerTokenTypes.hpp \
+	GptAssemblyLexerTokenTypes.txt GptAssemblyParser.cpp GptAssemblyParser.hpp gptasm \
+	GptAssemblyParserTokenTypes.hpp GptAssemblyParserTokenTypes.txt 

Added: trunk/gpt2/gptasm/src/lexer.g
===================================================================
--- trunk/gpt2/gptasm/src/lexer.g	2007-11-19 03:48:19 UTC (rev 373)
+++ trunk/gpt2/gptasm/src/lexer.g	2007-11-19 19:53:34 UTC (rev 374)
@@ -0,0 +1,358 @@
+header {
+   #include &lt;string&gt;
+  #include &lt;sstream&gt;
+//  #include &lt;iostream&gt;
+//  #include &lt;ctype.h&gt;
+//  #include &lt;antlr/TokenStreamSelector.hpp&gt;
+//
+//  using namespace antlr;
+//  using namespace std;
+}
+
+
+options {
+   language=&quot;Cpp&quot;;  
+}
+
+
+class GptAssemblyLexer extends Lexer;
+
+
+options {
+   k=2;
+   charVocabulary='\0'..'\377';
+   exportVocab=GptAssemblyLexer;
+  testLiterals = true;
+//  testLiterals = false;
+//  filter=T_INVALID;
+//  genHashLines=false;//no #line
+}
+
+
+tokens {
+   T_KW_PROGRAM=&quot;program&quot;;
+   T_KW_ENDPROGRAM=&quot;endprogram&quot;;
+   T_KW_USER=&quot;use&quot;;
+   T_KW_VAR=&quot;var&quot;;
+   T_KW_INT=&quot;int&quot;;
+   T_KW_REAL=&quot;real&quot;;
+   T_KW_CHAR=&quot;char&quot;;
+   T_KW_STRING=&quot;string&quot;;
+   T_KW_BOOL=&quot;bool&quot;;
+   T_KW_POINTER=&quot;pointer&quot;;
+   T_KW_MATRIX=&quot;matrix&quot;;
+   T_KW_PROC=&quot;proc&quot;;
+   T_KW_ENDPROC=&quot;endproc&quot;;
+   T_KW_PARAM=&quot;param&quot;;
+   T_KW_REF=&quot;ref&quot;;
+   T_KW_ISUM=&quot;isum&quot;;
+   T_KW_SSUM=&quot;ssum&quot;;
+   T_KW_RSUM=&quot;rsum&quot;;
+   T_KW_ISUB=&quot;isub&quot;;
+   T_KW_SSUB=&quot;ssub&quot;;
+   T_KW_RSUB=&quot;rsub&quot;;
+   T_KW_IMUL=&quot;imul&quot;;
+   T_KW_RMUL=&quot;rmul&quot;;
+   T_KW_IDIV=&quot;idiv&quot;;
+   T_KW_RDIV=&quot;rdiv&quot;;
+   T_KW_IMOD=&quot;imod&quot;;
+   T_KW_RMOD=&quot;rmod&quot;;
+   T_KW_IGE=&quot;ige&quot;;
+   T_KW_SGE=&quot;sge&quot;;
+   T_KW_RGE=&quot;rge&quot;;
+   T_KW_ILE=&quot;ile&quot;;
+   T_KW_SLE=&quot;sle&quot;;
+   T_KW_RLE=&quot;rle&quot;;
+   T_KW_INE=&quot;ine&quot;;
+   T_KW_SNE=&quot;sne&quot;;
+   T_KW_RNE=&quot;rne&quot;;
+   T_KW_IGT=&quot;igt&quot;;
+   T_KW_SGT=&quot;sgt&quot;;
+   T_KW_RGT=&quot;rgt&quot;;
+   T_KW_ILT=&quot;ilt&quot;;
+   T_KW_SLT=&quot;slt&quot;;
+   T_KW_RLT=&quot;rlt&quot;;
+   T_KW_IEQ=&quot;ieq&quot;;
+   T_KW_SEQ=&quot;seq&quot;;
+   T_KW_REQ=&quot;req&quot;;
+   T_KW_OR=&quot;or&quot;;
+   T_KW_AND=&quot;and&quot;;
+   T_KW_XOR=&quot;xor&quot;;
+   T_KW_INEG=&quot;ineg&quot;;
+   T_KW_RNEG=&quot;rneg&quot;;
+   T_KW_NOT=&quot;not&quot;;
+   T_KW_IINC=&quot;iinc&quot;;
+   T_KW_IDEC=&quot;idec&quot;;
+   T_KW_I2C=&quot;i2c&quot;;
+   T_KW_R2C=&quot;r2c&quot;;
+   T_KW_S2C=&quot;s2c&quot;;
+   T_KW_B2C=&quot;b2c&quot;;
+   T_KW_I2R=&quot;i2r&quot;;
+   T_KW_C2R=&quot;c2r&quot;;
+   T_KW_S2R=&quot;s2r&quot;;
+   T_KW_B2R=&quot;b2r&quot;;
+   T_KW_I2B=&quot;i2b&quot;;
+   T_KW_C2B=&quot;c2b&quot;;
+   T_KW_R2B=&quot;r2b&quot;;
+   T_KW_S2B=&quot;s2b&quot;;
+   T_KW_I2S=&quot;i2s&quot;;
+   T_KW_C2S=&quot;c2s&quot;;
+   T_KW_R2S=&quot;r2s&quot;;
+   T_KW_B2S=&quot;b2s&quot;;
+   T_KW_P2S=&quot;p2s&quot;;
+   T_KW_C2I=&quot;c2i&quot;;
+   T_KW_R2I=&quot;r2i&quot;;
+   T_KW_S2I=&quot;s2i&quot;;
+   T_KW_B2I=&quot;b2i&quot;;
+   T_KW_ISET=&quot;iset&quot;;
+   T_KW_SSET=&quot;sset&quot;;
+   T_KW_RSET=&quot;rset&quot;;
+   T_KW_GETA=&quot;geta&quot;;
+   T_KW_IGETV=&quot;igetv&quot;;
+   T_KW_SGETV=&quot;sgetv&quot;;
+   T_KW_RGETV=&quot;rgetv&quot;;
+   T_KW_ISETV=&quot;isetv&quot;;
+   T_KW_SSETV=&quot;ssetv&quot;;
+   T_KW_RSETV=&quot;rsetv&quot;;
+   T_KW_JMP=&quot;jmp&quot;;
+   T_KW_IF=&quot;if&quot;;
+   T_KW_IFNOT=&quot;ifnot&quot;;
+   T_KW_PUSH=&quot;push&quot;;
+   T_KW_POP=&quot;pop&quot;;
+   T_KW_INCSP=&quot;incsp&quot;;
+   T_KW_DECSP=&quot;decsp&quot;;
+//   T_KW_PUSH_0=&quot;push_0&quot;;
+//   T_KW_PUSH_1=&quot;push_1&quot;;
+//   T_KW_PUSH_2=&quot;push_2&quot;;
+//   T_KW_PUSH_3=&quot;push_3&quot;;
+//   T_KW_PUSH_4=&quot;push_4&quot;;
+//   T_KW_PUSH_5=&quot;push_5&quot;;
+   T_KW_PUSH_INT=&quot;push_int&quot;;
+   T_KW_PUSH_STRING=&quot;push_string&quot;;
+   T_KW_PUSH_REAL=&quot;push_real&quot;;
+   T_KW_PUSH_CHAR=&quot;push_char&quot;;
+   T_KW_PUSH_BOOL=&quot;push_bool&quot;;
+   T_KW_PUSH_MATRIX=&quot;push_matrix&quot;;
+   T_KW_PUSH_SP=&quot;push_sp&quot;;
+   T_KW_POP_SP=&quot;pop_sp&quot;;
+   T_KW_INCSP_4=&quot;incsp_4&quot;;
+   T_KW_INCSP_8=&quot;incsp_8&quot;;
+   T_KW_DECSP_4=&quot;decsp_4&quot;;
+   T_KW_DECSP_8=&quot;decsp_8&quot;;
+   T_KW_PCALL=&quot;pcall&quot;;
+   T_KW_RET=&quot;ret&quot;;
+   T_KW_SALLOC=&quot;salloc&quot;;
+   T_KW_SFREE=&quot;sfree&quot;;
+   T_KW_SSETC=&quot;ssetc&quot;;
+   T_KW_SGETC=&quot;sgetc&quot;;
+   T_KW_M1ALLOC=&quot;m1alloc&quot;;
+   T_KW_M2ALLOC=&quot;m2alloc&quot;;
+   T_KW_MFREE=&quot;mfree&quot;;
+   T_KW_M1SET=&quot;m1set&quot;;
+   T_KW_M1GET=&quot;m1get&quot;;
+   T_KW_M2SET=&quot;m2set&quot;;
+   T_KW_M2GET=&quot;m2get&quot;;
+   T_KW_MCOPY=&quot;mcopy&quot;;
+   T_KW_MGETSIZE1=&quot;mgetsize1&quot;;
+   T_KW_MGETSIZE2=&quot;mgetsize2&quot;;
+   T_KW_NOP=&quot;nop&quot;;
+//   T_KW_EXIT_0=&quot;exit_0&quot;;
+//   T_KW_EXIT_1=&quot;exit_1&quot;;
+   T_KW_HLT=&quot;hlt&quot;;
+   T_KW_EXIT=&quot;exit&quot;;
+   T_KW_TRUE=&quot;true&quot;;
+   T_KW_FALSE=&quot;false&quot;;
+   T_REAL_VALUE=&quot;n&#250;mero real&quot;; //nondeterminism T_INT_LIT &amp; T_REAL_LIT
+}
+
+
+{
+public:  
+//  void setNextFilename(string str) {
+//    nextFilename = str;
+//  }
+
+//  string getNextFilename( )
+//  {
+//    return nextFilename;
+//  }
+
+private:
+//  string nextFilename;
+//  TokenStreamSelector* selector;  
+//  bool hasLatim;
+}
+
+
+/******************* Constant literals ***********************/
+
+T_INT_VALUE
+options {
+   paraphrase = &quot;int number&quot;;
+}
+   : ('0' ('c'|'C') )=&gt; T_OCTAL_VALUE
+   | ('0' ('x'|'X') )=&gt; T_HEX_VALUE
+   | ('0' ('b'|'B') )=&gt; T_BIN_VALUE
+   | T_INTEGER_VALUE
+      (
+         '.' (T_DIGIT)+
+         {$setType(T_REAL_VALUE);}
+      )?
+   ;
+
+protected
+T_INTEGER_VALUE
+   : (T_DIGIT)+
+   ;
+
+protected
+T_OCTAL_VALUE
+   : '0' ('c'|'C')
+      {
+         //convert to base 10
+         std::string str = $getText;
+         int base10;
+         str = str.substr(2);//0c
+         base10 = strtoul(str.c_str(), NULL, 8);
+
+         std::stringstream s;
+         s &lt;&lt; base10;        
+         std::string res = s.str();
+         $setText(res);
+      }
+   ;
+
+protected
+T_HEX_VALUE
+   : '0' ('x'|'X')
+      {
+         //convert to base 10
+         std::string str = $getText;
+         int base10;
+         base10 = strtoul(str.c_str(), NULL, 16);
+  
+         std::stringstream s;
+         s &lt;&lt; base10;
+         std::string res = s.str();
+         $setText(res);      
+      }
+   ;
+
+protected
+T_BIN_VALUE
+   : '0' ('b'|'B')
+      {
+         //convert to base 10
+         int base10;
+         std::string str = $getText.substr(2);
+         base10 = strtoul(str.c_str(), NULL, 2);//0b
+
+         std::stringstream s;
+         s &lt;&lt; base10;
+         std::string res = s.str();
+         $setText(res);
+      }
+   ;
+
+T_CHAR_VALUE
+options {
+   paraphrase = &quot;char&quot;;
+}
+   : '\'' ( ~( '\'' | '\\' ) | ESC )? '\''
+   ;
+
+T_STRING_VALUE
+options {
+   paraphrase = &quot;string&quot;;
+}
+   : '&quot;'! ( ~( '&quot;' | '\\' | '\n' | '\r') | ESC)* '&quot;'!
+   ;
+
+protected
+ESC
+   : '\\' . //permite &quot;\a&quot; (possibilida ser avaliado posteriormente como &quot;a&quot;)
+   ;
+
+
+T_COLON
+options {
+   paraphrase = &quot;':'&quot;;
+}
+   : ':'
+   ;
+  
+T_COMMA
+options {
+   paraphrase = &quot;','&quot;;
+}
+   : ','
+   ;
+
+//T_DOT
+//options {
+//  paraphrase = &quot;'.'&quot;;
+//}
+//  : '.'
+//  ;
+
+T_WS_ : (' '
+   | '\t'
+   | '\n' { newline(); }
+   | '\r')
+      { $setType(antlr::Token::SKIP); }
+   ;
+
+SL_COMMENT
+   : &quot;//&quot; (~('\n'))* ('\n')?
+      { 
+         newline();
+         $setType(antlr::Token::SKIP);
+      }
+   ;
+
+ML_COMMENT
+{int line = getLine();}
+   : &quot;/*&quot; 
+      ( 
+         options { generateAmbigWarnings=false; } :  
+         '\n'                     {newline();}
+         | ('\r' '\n')=&gt; '\r' '\n'  {newline();}
+         | '\r'                     {newline();}
+         |~('*'|'\n'|'\r')
+         | ('*' ~'/' )=&gt; '*' 
+      )* 
+      &quot;*/&quot;
+      {$setType(antlr::Token::SKIP);}
+   ;
+
+exception
+catch[antlr::RecognitionException] {  
+   std::stringstream s;
+   s &lt;&lt; &quot;AVISO: coment&#225;rio iniciado na linha &quot; &lt;&lt; line &lt;&lt; &quot; n&#227;o termina com \&quot;*/\&quot;.&quot;;
+
+   _ttype = antlr::Token::SKIP;
+}
+
+T_ID
+   : (T_LETTER | '_') (T_LETTER | T_DIGIT | '_')*
+   ;
+
+protected
+T_DIGIT
+   : '0'..'9'
+   ;
+
+protected
+T_LETTER
+   : 'a'..'z'|'A'..'Z' | '\u00C0'..'\u00FF' /* latim-1 */
+   ;
+
+
+protected
+T_INVALID
+   : . 
+      {
+         printf(&quot;INVALID %d == '%x' -&gt; '%c'\n&quot;, $getText.c_str()[0], $getText.c_str()[0], $getText.c_str()[0]);
+      }
+   ;
+

Added: trunk/gpt2/gptasm/src/main.cpp
===================================================================
--- trunk/gpt2/gptasm/src/main.cpp	2007-11-19 03:48:19 UTC (rev 373)
+++ trunk/gpt2/gptasm/src/main.cpp	2007-11-19 19:53:34 UTC (rev 374)
@@ -0,0 +1,68 @@
+#include &lt;iostream&gt;
+#include &lt;string&gt;
+
+using namespace std;
+
+
+#include &quot;COptions.hpp&quot;
+#include &quot;CGptAsm.hpp&quot;
+
+
+void showSyntax();
+
+
+int main (int argc, char *argv[])
+{
+   int i;
+   COptions options;
+
+   cout &lt;&lt; &quot;GptAsm, release 0.1.0 (development release)&quot; &lt;&lt; endl;
+
+   while ((i = getopt(argc, argv, &quot;h&quot;)) != -1) {
+      switch (i) {
+         case 'h':
+            showSyntax();
+            return EXIT_SUCCESS;
+            break;
+         default:
+            break;
+      }
+   }
+
+   argc -= optind;
+   argv += optind;
+
+   if (argc &lt; 1) {
+      showSyntax();
+      return EXIT_FAILURE;
+   }
+
+   options.sourcefile = string(argv[0]) + &quot;.gasm&quot;;
+   options.destfile   = string(argv[0]) + &quot;.gvm&quot;;
+
+   cout &lt;&lt; &quot;Compiling &quot; &lt;&lt; options.sourcefile &lt;&lt; &quot;...&quot; &lt;&lt; endl;
+
+   CGptAsm gptc( &amp;options );
+
+   if (gptc.run()) {
+      cout &lt;&lt; &quot;Program &quot; &lt;&lt; options.sourcefile &lt;&lt; &quot; ok !!!&quot; &lt;&lt; endl &lt;&lt; endl;
+   } else {
+      cout &lt;&lt; &quot;Program &quot; &lt;&lt; options.sourcefile &lt;&lt; &quot; has errors...&quot; &lt;&lt; endl &lt;&lt; endl;
+      exit( EXIT_FAILURE );
+   }
+
+   return EXIT_SUCCESS;
+}
+
+
+void showSyntax() {
+   cout &lt;&lt; endl 
+        &lt;&lt; &quot;Desenvolvido por XXX, YYY e ZZZ&quot; &lt;&lt; endl 
+        &lt;&lt; &quot;Novembro, 2007&quot; &lt;&lt; endl 
+        &lt;&lt; endl 
+        &lt;&lt; &quot;Syntax: gptc [options] file&quot; &lt;&lt; endl 
+        &lt;&lt; &quot;Options:&quot; &lt;&lt; endl 
+        &lt;&lt; &quot;         -h help&quot; &lt;&lt; endl 
+        &lt;&lt; endl;
+}
+

Added: trunk/gpt2/gptasm/src/parser.g
===================================================================
--- trunk/gpt2/gptasm/src/parser.g	2007-11-19 03:48:19 UTC (rev 373)
+++ trunk/gpt2/gptasm/src/parser.g	2007-11-19 19:53:34 UTC (rev 374)
@@ -0,0 +1,371 @@
+header {
+   #include &lt;string&gt;
+   #include &quot;CGenBytecode.hpp&quot;
+   #include &lt;antlr/config.hpp&gt;
+   #include &lt;antlr/TokenStream.hpp&gt;
+   #include &lt;antlr/TokenBuffer.hpp&gt;
+   #include &quot;GptAssemblyParserTokenTypes.hpp&quot;
+   #include &lt;antlr/LLkParser.hpp&gt;
+   #include &quot;CSymbolList.hpp&quot;
+}
+
+options {
+  language=&quot;Cpp&quot;;  
+}
+
+{
+}
+
+class GptAssemblyParser extends Parser;
+
+options {
+  importVocab=GptAssemblyLexer;  // use vocab generated by lexer
+//  genHashLines=false;//no #line
+  k=2;
+}
+
+{  
+   public:
+      CGenBytecode bytecode;
+      void declareVar(const std::string&amp; lexeme, int type)
+      {
+         bytecode.makeVarDefinition( lexeme, type );
+      }
+      void declareParameter(const std::string&amp; lexeme, int type)
+      {
+         bytecode.makeParDefinition( lexeme, type );
+      }
+      antlr::RefToken getLastToken()
+      {
+         return LT(0);
+      }
+      std::string getLastTokenText()
+      {
+         return LT(0)-&gt;getText();
+      }
+}
+
+
+//####################################################################
+//####################### In&#237;cio da gram&#225;tica ########################
+//####################################################################
+
+//##############
+//## Programa ##
+//##############
+
+//--------------------------------------------------------
+  program [std::string filename] returns [std::string ret]
+//--------------------------------------------------------
+   : &quot;program&quot; T_ID
+     (imports)*
+     (var_declaration)*
+     (procedure_declaration)+
+     &quot;endprogram&quot;
+     EOF
+     {
+        ret = bytecode.getBinary();
+     }
+     ;
+
+//-------
+  imports
+//-------
+   : &quot;use&quot; T_STRING_VALUE
+   ;
+
+//#############################
+//## Declara&#231;&#227;o de vari&#225;veis ##
+//#############################
+
+//---------------
+  var_declaration
+//---------------
+{
+  char tk_type;
+}
+  : &quot;var&quot; tk_id:T_ID tk_type=primitive_type
+    { declareVar(tk_id-&gt;getText(), tk_type); }
+  ;
+
+//--------------------------------
+  primitive_type returns [char ret]
+//--------------------------------
+  : &quot;int&quot;     {ret=CSymbol::INT;}
+  | &quot;real&quot;    {ret=CSymbol::REAL;}
+  | &quot;char&quot;    {ret=CSymbol::CHAR;}
+  | &quot;string&quot;  {ret=CSymbol::STRING;}
+  | &quot;bool&quot;    {ret=CSymbol::BOOL;}
+//  | &quot;pointer&quot; {ret=CSymbol::POINTER;}
+  | &quot;matrix&quot;  {ret=CSymbol::MATRIX;}
+  ;
+
+//#################################
+//## Declaracao de procedimentos ##
+//#################################
+
+//---------------------
+  procedure_declaration
+//---------------------
+  : &quot;proc&quot; 
+   tk_id:T_ID
+    { bytecode.initProcedure(tk_id-&gt;getText(), false, 0, std::vector&lt;CSymbol&gt;()); }
+    (parameter_declaration)*
+    (var_declaration)*
+    code_block
+    { bytecode.finishProcedure(); }
+    &quot;endproc&quot;
+  ;
+
+//---------------------
+  parameter_declaration
+//---------------------
+{
+  int tk_type;
+}
+  : &quot;param&quot; (&quot;ref&quot;)? tk_id:T_ID tk_type=primitive_type { declareParameter( tk_id-&gt;getText(), tk_type ); }
+  ;
+
+//#####################
+//## Bloco de c&#243;digo ##
+//#####################
+
+//----------
+  code_block
+//----------
+  : (statement)*
+  ;
+
+//---------
+  statement
+//---------
+  :
+  ( label_definition
+  | mn_atribuicao_binaria
+  | mn_atribuicao_unaria
+  | mn_conversao_dados
+  | mn_copia_simples
+  | mn_address_and_pointer
+  | mn_salto
+  | mn_chamada_subrotina
+  | mn_manipulacao_strings
+  | mn_manipulacao_matrizes
+  | mn_execucao
+  )
+  ;
+
+//----------------
+  label_definition
+//----------------
+  : tk_id:T_ID T_COLON { bytecode.registryLabel(tk_id-&gt;getText()); }
+  ;
+
+//-----
+  label
+//-----
+   : T_ID
+   ;
+
+//---------------------
+  mn_atribuicao_binaria
+//---------------------
+   :  ( &quot;isum&quot;|&quot;ssum&quot;|&quot;rsum&quot;
+      | &quot;isub&quot;|&quot;ssub&quot;|&quot;rsub&quot;
+      | &quot;imul&quot;|&quot;rmul&quot;|&quot;idiv&quot;|&quot;rdiv&quot;
+      | &quot;imod&quot;|&quot;rmod&quot;
+      | &quot;ige&quot; |&quot;sge&quot; |&quot;rge&quot; |&quot;ile&quot;|&quot;sle&quot;|&quot;rle&quot;
+      | &quot;ine&quot; |&quot;sne&quot; |&quot;rne&quot;
+      | &quot;igt&quot; |&quot;sgt&quot; |&quot;rgt&quot;
+      | &quot;ilt&quot; |&quot;slt&quot; |&quot;rlt&quot;
+      | &quot;ieq&quot; |&quot;seq&quot; |&quot;req&quot;
+      | &quot;or&quot;  |&quot;and&quot; |&quot;xor&quot;
+      )
+      {bytecode.addOpcode(getLastTokenText());}
+      identifier T_COMMA element T_COMMA element
+   ;
+
+//--------------------
+  mn_atribuicao_unaria
+//--------------------
+   :  (&quot;ineg&quot;|&quot;rneg&quot;|&quot;not&quot;|&quot;iinc&quot;|&quot;idec&quot;) 
+      {bytecode.addOpcode(getLastTokenText());}
+      T_ID T_COMMA element
+   ;
+
+//------------------
+  mn_conversao_dados
+//------------------
+   :  ( &quot;i2c&quot;|&quot;r2c&quot;|&quot;s2c&quot;|&quot;b2c&quot;
+      | &quot;i2r&quot;|&quot;c2r&quot;|&quot;s2r&quot;|&quot;b2r&quot;
+      | &quot;i2b&quot;|&quot;c2b&quot;|&quot;r2b&quot;|&quot;s2b&quot;
+      | &quot;i2s&quot;|&quot;c2s&quot;|&quot;r2s&quot;|&quot;b2s&quot;|&quot;p2s&quot;
+      | &quot;c2i&quot;|&quot;r2i&quot;|&quot;s2i&quot;|&quot;b2i&quot;
+      )
+      {bytecode.addOpcode(getLastTokenText());}
+      T_ID T_COMMA element
+   ;
+
+//----------------
+  mn_copia_simples
+//----------------
+   :  ( &quot;iset&quot;|&quot;sset&quot;|&quot;rset&quot; )
+      {bytecode.addOpcode(getLastTokenText());}
+      identifier
+      T_COMMA
+      element
+   ;
+
+//----------------------
+  mn_address_and_pointer
+//----------------------
+   :  &quot;geta&quot;
+      {bytecode.addOpcode(getLastTokenText());}
+      T_ID T_COMMA T_ID
+   |  (&quot;igetv&quot;|&quot;sgetv&quot;|&quot;rgetv&quot;)
+      {bytecode.addOpcode(getLastTokenText());}
+      T_ID T_COMMA element T_COLON element
+   |  (&quot;isetv&quot;|&quot;ssetv&quot;|&quot;rsetv&quot;)
+      {bytecode.addOpcode(getLastTokenText());}
+      T_ID T_COLON element T_COMMA element
+   ;
+
+//--------
+  mn_salto
+//--------
+   :  &quot;jmp&quot; label
+      {bytecode.addOpcode(getLastTokenText());}
+   |  (&quot;if&quot;|&quot;ifnot&quot;)
+      {bytecode.addOpcode(getLastTokenText());}
+      T_ID T_COMMA label
+   ;
+
+//--------------------
+  mn_chamada_subrotina
+//--------------------
+   :  &quot;push&quot;
+      {bytecode.addOpcode(getLastTokenText());}
+      element
+   |  &quot;pop&quot;
+      {bytecode.addOpcode(getLastTokenText());}
+      T_ID
+   |  (&quot;incsp&quot;|&quot;decsp&quot;)
+      {bytecode.addOpcode(getLastTokenText());}
+      T_INT_VALUE
+      { bytecode.addAddress(getLastTokenText(), CSymbol::CONST, CSymbol::INT); }
+//   |  (&quot;push_0&quot;|&quot;push_1&quot;|&quot;push_2&quot;|&quot;push_3&quot;|&quot;push_4&quot;|&quot;push_5&quot;)
+//      {bytecode.addOpcode(getLastTokenText());}
+   |  (&quot;push_int&quot;|&quot;push_string&quot;|&quot;push_real&quot;|&quot;push_char&quot;|&quot;push_bool&quot;|&quot;push_matrix&quot;)
+      {bytecode.addOpcode(getLastTokenText());}
+   |  (&quot;push_sp&quot;|&quot;pop_sp&quot;)
+      {bytecode.addOpcode(getLastTokenText());}
+   |  (&quot;incsp_4&quot;|&quot;incsp_8&quot;|&quot;decsp_4&quot;|&quot;decsp_8&quot;)
+      {bytecode.addOpcode(getLastTokenText());}
+   |  &quot;pcall&quot;
+      {bytecode.addOpcode(getLastTokenText());}
+      T_ID
+      { bytecode.addAddress(getLastTokenText(),CSymbol::CONST, CSymbol::STRING); }
+   |  &quot;ret&quot;
+      {bytecode.addOpcode(getLastTokenText());}
+   ;
+
+//----------------------
+  mn_manipulacao_strings
+//----------------------
+   :  ( &quot;salloc&quot;|&quot;sfree&quot; )
+      {bytecode.addOpcode(getLastTokenText());}
+      T_ID
+   |  &quot;ssetc&quot;
+      {bytecode.addOpcode(getLastTokenText());}
+      T_ID T_COMMA element T_COMMA element
+   |  &quot;sgetc&quot;
+      {bytecode.addOpcode(getLastTokenText());}
+      T_ID T_COMMA T_ID T_COMMA element
+   ;
+
+//-----------------------
+  mn_manipulacao_matrizes
+//-----------------------
+   :  &quot;m1alloc&quot;
+      {bytecode.addOpcode(getLastTokenText());}
+      T_ID
+      T_COMMA 
+      T_INT_VALUE { bytecode.addAddress(getLastTokenText(), CSymbol::CONST, CSymbol::INT); }
+      T_COMMA 
+      T_INT_VALUE { bytecode.addAddress(getLastTokenText(), CSymbol::CONST, CSymbol::INT); }
+   |  &quot;m2alloc&quot;
+      {bytecode.addOpcode(getLastTokenText());}
+      T_ID T_COMMA T_INT_VALUE T_COMMA T_INT_VALUE T_COMMA T_INT_VALUE
+   |  &quot;mfree&quot;
+      {bytecode.addOpcode(getLastTokenText());}
+      T_ID
+   |  &quot;m1set&quot;
+      {bytecode.addOpcode(getLastTokenText());}
+      T_ID T_COMMA element T_COMMA element
+   |  &quot;m1get&quot;
+      {bytecode.addOpcode(getLastTokenText());}
+      T_ID T_COMMA T_ID T_COMMA element
+   |  &quot;m2set&quot;
+      {bytecode.addOpcode(getLastTokenText());}
+      T_ID T_COMMA element T_COMMA element T_COMMA element
+   |  &quot;m2get&quot;
+      {bytecode.addOpcode(getLastTokenText());}
+      T_ID T_COMMA T_ID T_COMMA element T_COMMA element
+   |  &quot;mcopy&quot;
+      {bytecode.addOpcode(getLastTokenText());}
+      T_ID T_COMMA T_ID
+   |  &quot;mgetsize1&quot;
+      {bytecode.addOpcode(getLastTokenText());}
+      T_ID T_COMMA T_ID
+   |  &quot;mgetsize2&quot;
+      {bytecode.addOpcode(getLastTokenText());}
+      T_ID T_COMMA T_ID
+   ;
+
+//-----------
+  mn_execucao
+//-----------
+//   :   (&quot;nop&quot;|&quot;exit_0&quot;|&quot;exit_1&quot;|&quot;hlt&quot;)
+   :   (&quot;nop&quot;|&quot;hlt&quot;)
+      {bytecode.addOpcode(getLastTokenText());}
+   |   &quot;exit&quot;
+      {bytecode.addOpcode(getLastTokenText());}
+       T_INT_VALUE
+  ;
+
+identifier
+  : id:T_ID { bytecode.addAddress(id-&gt;getText(),CSymbol::VAR, CSymbol::STRING); }
+  ;
+
+
+//#############
+//## Literal ##
+//#############
+
+//---------------------------------
+  literal //returns [std::string ret]
+//---------------------------------
+  : ( 
+        T_STRING_VALUE { bytecode.addAddress(getLastTokenText(), CSymbol::CONST, CSymbol::STRING); }
+      | T_INT_VALUE    { bytecode.addAddress(getLastTokenText(), CSymbol::CONST, CSymbol::INT); }
+      | T_REAL_VALUE   { bytecode.addAddress(getLastTokenText(), CSymbol::CONST, CSymbol::REAL); }
+      | T_CHAR_VALUE   { bytecode.addAddress(getLastTokenText(), CSymbol::CONST, CSymbol::CHAR); }
+      | &quot;true&quot;         { bytecode.addAddress(&quot;1&quot;,                CSymbol::CONST, CSymbol::INT); }
+      | &quot;false&quot;        { bytecode.addAddress(&quot;0&quot;,                CSymbol::CONST, CSymbol::INT); }
+    ) 
+  ;
+
+//op_unario
+//  : (
+//        e:T_MENOS
+//      | a:T_MAIS
+//    )?
+//  ; 
+
+//---------------------------------
+  element //returns [std::string ret]
+//---------------------------------
+  : identifier //{ bytecode.addAddress(getLastTokenText(), CSymbol::CONST, CSymbol::STRING); }
+//  | ret=literal
+  | literal
+  ;
+

Added: trunk/gpt2/gptasm/test/asm.sh
===================================================================
--- trunk/gpt2/gptasm/test/asm.sh	2007-11-19 03:48:19 UTC (rev 373)
+++ trunk/gpt2/gptasm/test/asm.sh	2007-11-19 19:53:34 UTC (rev 374)
@@ -0,0 +1,22 @@
+rm $1.gvm 1&gt;/dev/null 2&gt;&amp;1
+#rm $1.stdout 1&gt;/dev/null 2&gt;&amp;1
+
+../../gptasm $1
+if [ $? -ne 0 ]
+then
+	echo &quot;Erro: nao foi possivel assemblar $1.gasm&quot;
+	exit 1
+fi
+
+#./gvm $1 &gt; $1.stdout
+#if [ $? -ne 0 ]
+#then
+#	echo &quot;Erro: nao foi possivel executar $1.gvm&quot;
+#	exit 1
+#fi
+#echo &quot;&quot;
+
+#cat $1.stdout
+
+#cat $1.gasm
+


Property changes on: trunk/gpt2/gptasm/test/asm.sh
___________________________________________________________________
Name: svn:executable
   + *

Added: trunk/gpt2/gptasm/test/asm_all.sh
===================================================================
--- trunk/gpt2/gptasm/test/asm_all.sh	2007-11-19 03:48:19 UTC (rev 373)
+++ trunk/gpt2/gptasm/test/asm_all.sh	2007-11-19 19:53:34 UTC (rev 374)
@@ -0,0 +1,10 @@
+echo &quot;Assemblando todos os arquivos .gasm do diretorio&quot;
+
+rm *.gvm
+#rm *.stdout
+
+for i in `ls *.gasm -1 | sed s/&quot;\.gasm&quot;//g`
+do
+	./asm.sh $i 
+	echo &quot;&quot;
+done


Property changes on: trunk/gpt2/gptasm/test/asm_all.sh
___________________________________________________________________
Name: svn:executable
   + *

Added: trunk/gpt2/gptasm/test/check.sh
===================================================================
--- trunk/gpt2/gptasm/test/check.sh	2007-11-19 03:48:19 UTC (rev 373)
+++ trunk/gpt2/gptasm/test/check.sh	2007-11-19 19:53:34 UTC (rev 374)
@@ -0,0 +1,84 @@
+function exist_file( )
+{
+	if [ -z &quot;$1&quot; ]                    # Checks if parameter #1 is zero length.
+	then
+		echo &quot;-Parameter #1 is zero length.&quot;
+		return 1
+	fi
+
+	if [ &quot;$2&quot; ] # verifica se o parametro existe
+	then
+		echo &quot;-Parameter #2 is \&quot;$2\&quot;.-&quot;
+	fi
+					  
+	if [[ ! -a $1 ]]
+	then
+		echo &quot;Erro: Arquivo $1 nao existe !!!&quot;
+		return 1
+	fi
+
+	return 0
+}
+
+echo &quot;Realizando o teste regressivo no arquivo $1.gasm&quot;
+
+exist_file $1.gasm
+if [ $? -ne 0 ]
+then
+	exit 2
+fi
+
+exist_file checked/$1.gasm
+if [ $? -ne 0 ]
+then
+	exit 2
+fi
+
+exist_file checked/$1.gvm
+if [ $? -ne 0 ]
+then
+	exit 2
+fi
+
+#exist_file checked/$1.stdout
+#if [ $? -ne 0 ]
+#then
+#	exit 2
+#fi
+
+diff $1.gasm checked/$1.gasm &gt;/dev/null 2&gt;&amp;1
+if [ $? -ne 0 ]
+then
+	echo &quot;Erro: Os arquivos $1.gasm e checked/$1.gasm sao diferentes. Nao eh possivel realizar o teste regressivo !&quot;
+	exit 2
+fi
+
+./asm.sh $1
+if [ $? -ne 0 ]
+then
+	echo &quot;Erro: Arquivo $1.gasm nao foi compilado corretamente&quot;
+	exit 2
+fi
+
+diff $1.gvm checked/$1.gvm &gt;/dev/null 2&gt;&amp;1
+if [ $? -ne 0 ]
+then
+	echo &quot;Erro: Teste regressivo falhou. Os arquivos $1.gvm e checked/$1.gvm sao diferentes !!!&quot;
+	gdumpasm -D$1
+	gdumpasm -Dchecked/$1
+	vimdiff $1.dump checked/$1.dump
+	exit 1
+fi
+
+#diff $1.stdout checked/$1.stdout &gt;/dev/null 2&gt;&amp;1
+#if [ $? -ne 0 ]
+#then
+#	echo &quot;Erro: Teste regressivo falhou. Os arquivos $1.stdout e checked/$1.stdout sao diferentes !!!&quot;
+#	vimdiff $1.stdout checked/$1.stdout
+#	exit 1
+#fi
+
+echo &quot;Ok: Teste regressivo ok para $1.gasm&quot;
+
+exit 0
+


Property changes on: trunk/gpt2/gptasm/test/check.sh
___________________________________________________________________
Name: svn:executable
   + *

Added: trunk/gpt2/gptasm/test/check_all.sh
===================================================================
--- trunk/gpt2/gptasm/test/check_all.sh	2007-11-19 03:48:19 UTC (rev 373)
+++ trunk/gpt2/gptasm/test/check_all.sh	2007-11-19 19:53:34 UTC (rev 374)
@@ -0,0 +1,14 @@
+echo &quot;Realizando o teste regressivo em todos os arquivos .gasm do diretorio&quot;
+
+rm *.gvm 1&gt;/dev/null 2&gt;&amp;1
+rm *.stdout 1&gt;/dev/null 2&gt;&amp;1
+
+for i in `ls *.gasm -1 | sed s/&quot;\.gasm&quot;//g`
+do
+	./check.sh $i 
+	echo &quot;&quot;
+#	if [ $? -ne 0 ]
+#	then
+#		echo &quot;Falha no teste regressivo do arquivo $i&quot;;
+#	fi
+done


Property changes on: trunk/gpt2/gptasm/test/check_all.sh
___________________________________________________________________
Name: svn:executable
   + *

Added: trunk/gpt2/gptasm/test/gerados_pelo_gptc/constantes_1.gasm
===================================================================
--- trunk/gpt2/gptasm/test/gerados_pelo_gptc/constantes_1.gasm	2007-11-19 03:48:19 UTC (rev 373)
+++ trunk/gpt2/gptasm/test/gerados_pelo_gptc/constantes_1.gasm	2007-11-19 19:53:34 UTC (rev 374)
@@ -0,0 +1,23 @@
+// Programa constantes_1.gasm gerado a partir de constantes_1.gpt
+program constantes_1
+
+var i int
+// Procedure main
+proc main
+	var __temp_1 int
+	iset i, 1
+	__label_1:
+	ile __temp_1, i, total
+	ifnot __temp_1, __label_2
+	push i
+	push_int
+	push 1
+	pcall imprima
+	iinc i, 1
+	jmp __label_1
+	__label_2:
+	exit 0
+endproc
+// Fim da procedure
+
+endprogram

Added: trunk/gpt2/gptasm/test/gerados_pelo_gptc/estruturas_condicionais_1.gasm
===================================================================
--- trunk/gpt2/gptasm/test/gerados_pelo_gptc/estruturas_condicionais_1.gasm	2007-11-19 03:48:19 UTC (rev 373)
+++ trunk/gpt2/gptasm/test/gerados_pelo_gptc/estruturas_condicionais_1.gasm	2007-11-19 19:53:34 UTC (rev 374)
@@ -0,0 +1,24 @@
+// Programa estruturas_condicionais_1.gasm gerado a partir de estruturas_condicionais_1.gpt
+program estruturas_condicionais_1
+
+var x int
+// Procedure main
+proc main
+	var __temp_1 int
+	iset x, 10
+	ige __temp_1, x, 20
+	ifnot __temp_1, __label_1
+	iset x, 2
+	jmp __label_2
+	__label_1:
+	iset x, 1
+	__label_2:
+	push x
+	push_int
+	push 1
+	pcall imprima
+	exit 0
+endproc
+// Fim da procedure
+
+endprogram

Added: trunk/gpt2/gptasm/test/gerados_pelo_gptc/estruturas_condicionais_2.gasm
===================================================================
--- trunk/gpt2/gptasm/test/gerados_pelo_gptc/estruturas_condicionais_2.gasm	2007-11-19 03:48:19 UTC (rev 373)
+++ trunk/gpt2/gptasm/test/gerados_pelo_gptc/estruturas_condicionais_2.gasm	2007-11-19 19:53:34 UTC (rev 374)
@@ -0,0 +1,36 @@
+// Programa estruturas_condicionais_2.gasm gerado a partir de estruturas_condicionais_2.gpt
+program estruturas_condicionais_2
+
+var x int
+// Procedure main
+proc main
+	var __temp_1 int
+	var __temp_2 int
+	iset x, 20
+	ige __temp_1, x, 0
+	ifnot __temp_1, __label_1
+	igt __temp_2, x, 40
+	ifnot __temp_2, __label_2
+	push &quot;x&gt;40&quot;
+	push_string
+	push 1
+	pcall imprima
+	jmp __label_3
+	__label_2:
+	push &quot;x&lt;=40&quot;
+	push_string
+	push 1
+	pcall imprima
+	__label_3:
+	jmp __label_4
+	__label_1:
+	push &quot;x eh negativo !!!&quot;
+	push_string
+	push 1
+	pcall imprima
+	__label_4:
+	exit 0
+endproc
+// Fim da procedure
+
+endprogram

Added: trunk/gpt2/gptasm/test/gerados_pelo_gptc/estruturas_condicionais_3.gasm
===================================================================
--- trunk/gpt2/gptasm/test/gerados_pelo_gptc/estruturas_condicionais_3.gasm	2007-11-19 03:48:19 UTC (rev 373)
+++ trunk/gpt2/gptasm/test/gerados_pelo_gptc/estruturas_condicionais_3.gasm	2007-11-19 19:53:34 UTC (rev 374)
@@ -0,0 +1,30 @@
+// Programa estruturas_condicionais_3.gasm gerado a partir de estruturas_condicionais_3.gpt
+program estruturas_condicionais_3
+
+var x int
+// Procedure main
+proc main
+	var __temp_1 int
+	var __temp_2 int
+	var __temp_3 int
+	iset x, 1
+	ige __temp_1, x, 1
+	ile __temp_2, x, 10
+	and __temp_3, __temp_1, __temp_2
+	ifnot __temp_3, __label_1
+	push &quot;x entre 1 e 10&quot;
+	push_string
+	push 1
+	pcall imprima
+	jmp __label_2
+	__label_1:
+	push &quot;x n&#227;o est&#225; entre 1 e 10&quot;
+	push_string
+	push 1
+	pcall imprima
+	__label_2:
+	exit 0
+endproc
+// Fim da procedure
+
+endprogram

Added: trunk/gpt2/gptasm/test/gerados_pelo_gptc/estruturas_condicionais_4.gasm
===================================================================
--- trunk/gpt2/gptasm/test/gerados_pelo_gptc/estruturas_condicionais_4.gasm	2007-11-19 03:48:19 UTC (rev 373)
+++ trunk/gpt2/gptasm/test/gerados_pelo_gptc/estruturas_condicionais_4.gasm	2007-11-19 19:53:34 UTC (rev 374)
@@ -0,0 +1,41 @@
+// Programa estruturas_condicionais_4.gasm gerado a partir de estruturas_condicionais_4.gpt
+program estruturas_condicionais_4
+
+var x int
+// Procedure main
+proc main
+	var __temp_1 int
+	var __temp_2 int
+	var __temp_3 int
+	var __temp_4 int
+	push 0
+	pcall leia
+	pop __temp_1
+	iset x, __temp_1
+	iset __temp_2, x
+	ieq __temp_3, __temp_2, 1
+	ifnot __temp_3, __label_2
+	push &quot;x = um&quot;
+	push_string
+	push 1
+	pcall imprima
+	jmp __label_1
+	__label_2:
+	ieq __temp_4, __temp_2, 2
+	ifnot __temp_4, __label_3
+	push &quot;x = dois&quot;
+	push_string
+	push 1
+	pcall imprima
+	jmp __label_1
+	__label_3:
+	push &quot;x diferente de um e dois&quot;
+	push_string
+	push 1
+	pcall imprima
+	__label_1:
+	exit 0
+endproc
+// Fim da procedure
+
+endprogram

Added: trunk/gpt2/gptasm/test/gerados_pelo_gptc/estruturas_condicionais_5.gasm
===================================================================
--- trunk/gpt2/gptasm/test/gerados_pelo_gptc/estruturas_condicionais_5.gasm	2007-11-19 03:48:19 UTC (rev 373)
+++ trunk/gpt2/gptasm/test/gerados_pelo_gptc/estruturas_condicionais_5.gasm	2007-11-19 19:53:34 UTC (rev 374)
@@ -0,0 +1,23 @@
+// Programa estruturas_condicionais_5.gasm gerado a partir de estruturas_condicionais_5.gpt
+program estruturas_condicionais_5
+
+var x int
+// Procedure main
+proc main
+	var __temp_1 int
+	iset x, 10
+	ige __temp_1, x, 20
+	ifnot __temp_1, __label_1
+	iset x, 2
+	jmp __label_2
+	__label_1:
+	__label_2:
+	push x
+	push_int
+	push 1
+	pcall imprima
+	exit 0
+endproc
+// Fim da procedure
+
+endprogram

Added: trunk/gpt2/gptasm/test/gerados_pelo_gptc/estruturas_repeticao_1.gasm
===================================================================
--- trunk/gpt2/gptasm/test/gerados_pelo_gptc/estruturas_repeticao_1.gasm	2007-11-19 03:48:19 UTC (rev 373)
+++ trunk/gpt2/gptasm/test/gerados_pelo_gptc/estruturas_repeticao_1.gasm	2007-11-19 19:53:34 UTC (rev 374)
@@ -0,0 +1,23 @@
+// Programa estruturas_repeticao_1.gasm gerado a partir de estruturas_repeticao_1.gpt
+program estruturas_repeticao_1
+
+var x int
+// Procedure main
+proc main
+	var __temp_1 int
+	iset x, 1
+	__label_1:
+	ile __temp_1, x, 10
+	ifnot __temp_1, __label_2
+	push x
+	push_int
+	push 1
+	pcall imprima
+	iinc x, 1
+	jmp __label_1
+	__label_2:
+	exit 0
+endproc
+// Fim da procedure
+
+endprogram

Added: trunk/gpt2/gptasm/test/gerados_pelo_gptc/estruturas_repeticao_2.gasm
===================================================================
--- trunk/gpt2/gptasm/test/gerados_pelo_gptc/estruturas_repeticao_2.gasm	2007-11-19 03:48:19 UTC (rev 373)
+++ trunk/gpt2/gptasm/test/gerados_pelo_gptc/estruturas_repeticao_2.gasm	2007-11-19 19:53:34 UTC (rev 374)
@@ -0,0 +1,23 @@
+// Programa estruturas_repeticao_2.gasm gerado a partir de estruturas_repeticao_2.gpt
+program estruturas_repeticao_2
+
+var x int
+// Procedure main
+proc main
+	var __temp_1 int
+	iset x, 100
+	__label_1:
+	ige __temp_1, x, 0
+	ifnot __temp_1, __label_2
+	push x
+	push_int
+	push 1
+	pcall imprima
+	idec x, 2
+	jmp __label_1
+	__label_2:
+	exit 0
+endproc
+// Fim da procedure
+
+endprogram

Added: trunk/gpt2/gptasm/test/gerados_pelo_gptc/estruturas_repeticao_3.gasm
===================================================================
--- trunk/gpt2/gptasm/test/gerados_pelo_gptc/estruturas_repeticao_3.gasm	2007-11-19 03:48:19 UTC (rev 373)
+++ trunk/gpt2/gptasm/test/gerados_pelo_gptc/estruturas_repeticao_3.gasm	2007-11-19 19:53:34 UTC (rev 374)
@@ -0,0 +1,25 @@
+// Programa estruturas_repeticao_3.gasm gerado a partir de estruturas_repeticao_3.gpt
+program estruturas_repeticao_3
+
+var x int
+// Procedure main
+proc main
+	var __temp_1 int
+	var __temp_2 int
+	iset x, 1
+	__label_1:
+	ile __temp_1, x, 10
+	ifnot __temp_1, __label_2
+	push x
+	push_int
+	push 1
+	pcall imprima
+	isum __temp_2, x, 1
+	iset x, __temp_2
+	jmp __label_1
+	__label_2:
+	exit 0
+endproc
+// Fim da procedure
+
+endprogram

Added: trunk/gpt2/gptasm/test/gerados_pelo_gptc/estruturas_repeticao_4.gasm
===================================================================
--- trunk/gpt2/gptasm/test/gerados_pelo_gptc/estruturas_repeticao_4.gasm	2007-11-19 03:48:19 UTC (rev 373)
+++ trunk/gpt2/gptasm/test/gerados_pelo_gptc/estruturas_repeticao_4.gasm	2007-11-19 19:53:34 UTC (rev 374)
@@ -0,0 +1,23 @@
+// Programa estruturas_repeticao_4.gasm gerado a partir de estruturas_repeticao_4.gpt
+program estruturas_repeticao_4
+
+var x int
+// Procedure main
+proc main
+	var __temp_1 int
+	var __temp_2 int
+	iset x, 1
+	__label_1:
+	push x
+	push_int
+	push 1
+	pcall imprima
+	isum __temp_1, x, 1
+	iset x, __temp_1
+	igt __temp_2, x, 10
+	ifnot __temp_2, __label_1
+	exit 0
+endproc
+// Fim da procedure
+
+endprogram

Added: trunk/gpt2/gptasm/test/gerados_pelo_gptc/expressoes_matematicas_1.gasm
===================================================================
--- trunk/gpt2/gptasm/test/gerados_pelo_gptc/expressoes_matematicas_1.gasm	2007-11-19 03:48:19 UTC (rev 373)
+++ trunk/gpt2/gptasm/test/gerados_pelo_gptc/expressoes_matematicas_1.gasm	2007-11-19 19:53:34 UTC (rev 374)
@@ -0,0 +1,38 @@
+// Programa expressoes_matematicas_1.gasm gerado a partir de expressoes_matematicas_1.gpt
+program expressoes_matematicas_1
+
+var t1 int
+var t2 int
+// Procedure main
+proc main
+	var __temp_1 int
+	var __temp_2 int
+	var __temp_3 int
+	var __temp_4 int
+	var __temp_5 int
+	isum __temp_1, 1, 2
+	iset t1, __temp_1
+	imul __temp_2, 5, 3
+	iset t1, __temp_2
+	isum __temp_3, 2, t1
+	iset t2, __temp_3
+	push t2
+	push_int
+	push &quot;2+5*3=&quot;
+	push_string
+	push 2
+	pcall imprima
+	imul __temp_4, 5, 3
+	isum __temp_5, 2, __temp_4
+	iset t1, __temp_5
+	push t1
+	push_int
+	push &quot;2+5*3=&quot;
+	push_string
+	push 2
+	pcall imprima
+	exit 0
+endproc
+// Fim da procedure
+
+endprogram

Added: trunk/gpt2/gptasm/test/gerados_pelo_gptc/expressoes_matematicas_2.gasm
===================================================================
--- trunk/gpt2/gptasm/test/gerados_pelo_gptc/expressoes_matematicas_2.gasm	2007-11-19 03:48:19 UTC (rev 373)
+++ trunk/gpt2/gptasm/test/gerados_pelo_gptc/expressoes_matematicas_2.gasm	2007-11-19 19:53:34 UTC (rev 374)
@@ -0,0 +1,20 @@
+// Programa expressoes_matematicas_2.gasm gerado a partir de expressoes_matematicas_2.gpt
+program expressoes_matematicas_2
+
+// Procedure main
+proc main
+	var __temp_1 int
+	var __temp_2 int
+	imul __temp_1, 5, 3
+	isum __temp_2, 2, __temp_1
+	push __temp_2
+	push_int
+	push &quot;2+5*3=&quot;
+	push_string
+	push 2
+	pcall imprima
+	exit 0
+endproc
+// Fim da procedure
+
+endprogram

Added: trunk/gpt2/gptasm/test/gerados_pelo_gptc/funcoes_definidas_usuario_1.gasm
===================================================================
--- trunk/gpt2/gptasm/test/gerados_pelo_gptc/funcoes_definidas_usuario_1.gasm	2007-11-19 03:48:19 UTC (rev 373)
+++ trunk/gpt2/gptasm/test/gerados_pelo_gptc/funcoes_definidas_usuario_1.gasm	2007-11-19 19:53:34 UTC (rev 374)
@@ -0,0 +1,34 @@
+// Programa funcoes_definidas_usuario_1.gasm gerado a partir de funcoes_definidas_usuario_1.gpt
+program funcoes_definidas_usuario_1
+
+// Procedure main
+proc main
+	var __temp_1 int
+	push 0
+	push 7
+	push 2
+	pcall soma
+	pop __temp_1
+	push __temp_1
+	push_int
+	push &quot;A soma &#233;: &quot;
+	push_string
+	push 2
+	pcall imprima
+	exit 0
+endproc
+// Fim da procedure
+
+// Procedure soma
+proc soma
+	param x int
+	param y int
+	var __result int
+	var __temp_2 int
+	isum __temp_2, x, y
+	iset __result, __temp_2
+	ret
+endproc
+// Fim da procedure
+
+endprogram

Added: trunk/gpt2/gptasm/test/gerados_pelo_gptc/funcoes_definidas_usuario_2.gasm
===================================================================
--- trunk/gpt2/gptasm/test/gerados_pelo_gptc/funcoes_definidas_usuario_2.gasm	2007-11-19 03:48:19 UTC (rev 373)
+++ trunk/gpt2/gptasm/test/gerados_pelo_gptc/funcoes_definidas_usuario_2.gasm	2007-11-19 19:53:34 UTC (rev 374)
@@ -0,0 +1,61 @@
+// Programa funcoes_definidas_usuario_2.gasm gerado a partir de funcoes_definidas_usuario_2.gpt
+program funcoes_definidas_usuario_2
+
+var x int
+// Procedure main
+proc main
+	var __temp_1 int
+	var __temp_2 int
+	push &quot;Digite um n&#250;mero:&quot;
+	push_string
+	push 1
+	pcall imprima
+	push 0
+	pcall leia
+	pop __temp_1
+	iset x, __temp_1
+	push 0
+	push x
+	pcall fatorial
+	pop __temp_2
+	push __temp_2
+	push_int
+	push &quot;&#233; &quot;
+	push_string
+	push x
+	push_int
+	push &quot;Fatorial de &quot;
+	push_string
+	push 4
+	pcall imprima
+	exit 0
+endproc
+// Fim da procedure
+
+// Procedure fatorial
+proc fatorial
+	param z int
+	var __result int
+	var __temp_3 int
+	var __temp_4 int
+	var __temp_5 int
+	var __temp_6 int
+	ieq __temp_3, z, 1
+	ifnot __temp_3, __label_1
+	iset __result, 1
+	ret
+	jmp __label_2
+	__label_1:
+	push 0
+	isub __temp_4, z, 1
+	push __temp_4
+	pcall fatorial
+	pop __temp_5
+	imul __temp_6, z, __temp_5
+	iset __result, __temp_6
+	ret
+	__label_2:
+endproc
+// Fim da procedure
+
+endprogram

Added: trunk/gpt2/gptasm/test/gerados_pelo_gptc/inline_codigo_gptassembly.gasm
===================================================================
--- trunk/gpt2/gptasm/test/gerados_pelo_gptc/inline_codigo_gptassembly.gasm	2007-11-19 03:48:19 UTC (rev 373)
+++ trunk/gpt2/gptasm/test/gerados_pelo_gptc/inline_codigo_gptassembly.gasm	2007-11-19 19:53:34 UTC (rev 374)
@@ -0,0 +1,28 @@
+// Programa inline_codigo_gptassembly.gasm gerado a partir de inline_codigo_gptassembly.gpt
+program inline_codigo_gptassembly
+
+var x int
+// Procedure main
+proc main
+	iset x, 10
+	push x
+	push_int
+	push 1
+	pcall imprima
+
+	// asm-begin
+	
+        iset x, 20
+        isum x, x, 80
+    
+	// asm-end
+
+	push x
+	push_int
+	push 1
+	pcall imprima
+	exit 0
+endproc
+// Fim da procedure
+
+endprogram

Added: trunk/gpt2/gptasm/test/gerados_pelo_gptc/invocando_subrotinas_linguagem_1.gasm
===================================================================
--- trunk/gpt2/gptasm/test/gerados_pelo_gptc/invocando_subrotinas_linguagem_1.gasm	2007-11-19 03:48:19 UTC (rev 373)
+++ trunk/gpt2/gptasm/test/gerados_pelo_gptc/invocando_subrotinas_linguagem_1.gasm	2007-11-19 19:53:34 UTC (rev 374)
@@ -0,0 +1,14 @@
+// Programa invocando_subrotinas_linguagem_1.gasm gerado a partir de invocando_subrotinas_linguagem_1.gpt
+program invocando_subrotinas_linguagem_1
+
+// Procedure main
+proc main
+	push &quot;Ol&#225; mundo !!!&quot;
+	push_string
+	push 1
+	pcall imprima
+	exit 0
+endproc
+// Fim da procedure
+
+endprogram

Added: trunk/gpt2/gptasm/test/gerados_pelo_gptc/invocando_subrotinas_linguagem_2.gasm
===================================================================
--- trunk/gpt2/gptasm/test/gerados_pelo_gptc/invocando_subrotinas_linguagem_2.gasm	2007-11-19 03:48:19 UTC (rev 373)
+++ trunk/gpt2/gptasm/test/gerados_pelo_gptc/invocando_subrotinas_linguagem_2.gasm	2007-11-19 19:53:34 UTC (rev 374)
@@ -0,0 +1,26 @@
+// Programa invocando_subrotinas_linguagem_2.gasm gerado a partir de invocando_subrotinas_linguagem_2.gpt
+program invocando_subrotinas_linguagem_2
+
+var x int
+// Procedure main
+proc main
+	var __temp_1 int
+	push &quot;Digite um n&#250;mero: &quot;
+	push_string
+	push 1
+	pcall imprima
+	push 0
+	pcall leia
+	pop __temp_1
+	iset x, __temp_1
+	push x
+	push_int
+	push &quot;O n&#250;mero digitado foi &quot;
+	push_string
+	push 2
+	pcall imprima
+	exit 0
+endproc
+// Fim da procedure
+
+endprogram

Added: trunk/gpt2/gptasm/test/gerados_pelo_gptc/matrizes_1.gasm
===================================================================
--- trunk/gpt2/gptasm/test/gerados_pelo_gptc/matrizes_1.gasm	2007-11-19 03:48:19 UTC (rev 373)
+++ trunk/gpt2/gptasm/test/gerados_pelo_gptc/matrizes_1.gasm	2007-11-19 19:53:34 UTC (rev 374)
@@ -0,0 +1,39 @@
+// Programa matrizes_1.gasm gerado a partir de matrizes_1.gpt
+program matrizes_1
+
+var m matrix
+var i int
+// Procedure main
+proc main
+	var __temp_1 int
+	var __temp_2 int
+	var __temp_3 int
+	iset i, 1
+	__label_1:
+	ile __temp_1, i, 10
+	ifnot __temp_1, __label_2
+	imul __temp_2, i, 10
+	m1set m, __temp_2
+	iinc i, 1
+	jmp __label_1
+	__label_2:
+	push &quot;Valores das coordenadas:&quot;
+	push_string
+	push 1
+	pcall imprima
+	iset i, 1
+	__label_3:
+	ile __temp_3, i, 10
+	ifnot __temp_3, __label_4
+	push m
+	push_matrix
+	push 1
+	pcall imprima
+	iinc i, 1
+	jmp __label_3
+	__label_4:
+	exit 0
+endproc
+// Fim da procedure
+
+endprogram

Added: trunk/gpt2/gptasm/test/gerados_pelo_gptc/matrizes_2.gasm
===================================================================
--- trunk/gpt2/gptasm/test/gerados_pelo_gptc/matrizes_2.gasm	2007-11-19 03:48:19 UTC (rev 373)
+++ trunk/gpt2/gptasm/test/gerados_pelo_gptc/matrizes_2.gasm	2007-11-19 19:53:34 UTC (rev 374)
@@ -0,0 +1,45 @@
+// Programa matrizes_2.gasm gerado a partir de matrizes_2.gpt
+program matrizes_2
+
+var x int
+var y int
+var c ERRO !!!
+var i int
+// Procedure main
+proc main
+	var __temp_1 int
+	var __temp_2 int
+	var __temp_3 int
+	var __temp_4 int
+	iset i, 1
+	__label_1:
+	ile __temp_1, i, 10
+	ifnot __temp_1, __label_2
+	imul __temp_2, i, 10
+	iset x, __temp_2
+	imul __temp_3, i, 100
+	iset y, __temp_3
+	iinc i, 1
+	jmp __label_1
+	__label_2:
+	push &quot;Valores das coordenadas:&quot;
+	push_string
+	push 1
+	pcall imprima
+	iset i, 1
+	__label_3:
+	ile __temp_4, i, 10
+	ifnot __temp_4, __label_4
+	push c
+	push_desconhecido
+	push &quot;x=&quot;
+	push_string
+	push 2
+	iinc i, 1
+	jmp __label_3
+	__label_4:
+	exit 0
+endproc
+// Fim da procedure
+
+endprogram

Added: trunk/gpt2/gptasm/test/gerados_pelo_gptc/matrizes_3.gasm
===================================================================
--- trunk/gpt2/gptasm/test/gerados_pelo_gptc/matrizes_3.gasm	2007-11-19 03:48:19 UTC (rev 373)
+++ trunk/gpt2/gptasm/test/gerados_pelo_gptc/matrizes_3.gasm	2007-11-19 19:53:34 UTC (rev 374)
@@ -0,0 +1,28 @@
+// Programa matrizes_3.gasm gerado a partir de matrizes_3.gpt
+program matrizes_3
+
+// Procedure main
+proc main
+	pcall mostra
+	exit 0
+endproc
+// Fim da procedure
+
+// Procedure mostra
+proc mostra
+	var resultado matrix
+	var __temp_1 matrix
+	m1set resultado, 10
+	m1set resultado, 20
+	m1sum __temp_1, resultado, resultado
+	m1set resultado, __temp_1
+	push resultado
+	push_matrix
+	push &quot;resultado[2]=&quot;
+	push_string
+	push 2
+	pcall imprima
+endproc
+// Fim da procedure
+
+endprogram

Added: trunk/gpt2/gptasm/test/gerados_pelo_gptc/matrizes_4.gasm
===================================================================
--- trunk/gpt2/gptasm/test/gerados_pelo_gptc/matrizes_4.gasm	2007-11-19 03:48:19 UTC (rev 373)
+++ trunk/gpt2/gptasm/test/gerados_pelo_gptc/matrizes_4.gasm	2007-11-19 19:53:34 UTC (rev 374)
@@ -0,0 +1,15 @@
+// Programa matrizes_4.gasm gerado a partir de matrizes_4.gpt
+program matrizes_4
+
+var x matrix
+// Procedure main
+proc main
+	push x
+	push_matrix
+	push 1
+	pcall imprima
+	exit 0
+endproc
+// Fim da procedure
+
+endprogram

Added: trunk/gpt2/gptasm/test/gerados_pelo_gptc/procedimentos_definidos_usuario_1.gasm
===================================================================
--- trunk/gpt2/gptasm/test/gerados_pelo_gptc/procedimentos_definidos_usuario_1.gasm	2007-11-19 03:48:19 UTC (rev 373)
+++ trunk/gpt2/gptasm/test/gerados_pelo_gptc/procedimentos_definidos_usuario_1.gasm	2007-11-19 19:53:34 UTC (rev 374)
@@ -0,0 +1,24 @@
+// Programa procedimentos_definidos_usuario_1.gasm gerado a partir de procedimentos_definidos_usuario_1.gpt
+program procedimentos_definidos_usuario_1
+
+// Procedure main
+proc main
+	pcall soma
+	exit 0
+endproc
+// Fim da procedure
+
+// Procedure soma
+proc soma
+	var __temp_1 int
+	isum __temp_1, 2, 7
+	push __temp_1
+	push_int
+	push &quot;A soma de 2 + 7 &#233;: &quot;
+	push_string
+	push 2
+	pcall imprima
+endproc
+// Fim da procedure
+
+endprogram

Added: trunk/gpt2/gptasm/test/gerados_pelo_gptc/procedimentos_definidos_usuario_2.gasm
===================================================================
--- trunk/gpt2/gptasm/test/gerados_pelo_gptc/procedimentos_definidos_usuario_2.gasm	2007-11-19 03:48:19 UTC (rev 373)
+++ trunk/gpt2/gptasm/test/gerados_pelo_gptc/procedimentos_definidos_usuario_2.gasm	2007-11-19 19:53:34 UTC (rev 374)
@@ -0,0 +1,28 @@
+// Programa procedimentos_definidos_usuario_2.gasm gerado a partir de procedimentos_definidos_usuario_2.gpt
+program procedimentos_definidos_usuario_2
+
+// Procedure main
+proc main
+	push 7
+	push 2
+	pcall soma
+	exit 0
+endproc
+// Fim da procedure
+
+// Procedure soma
+proc soma
+	param x int
+	param y int
+	var __temp_1 int
+	isum __temp_1, x, y
+	push __temp_1
+	push_int
+	push &quot;A soma &#233;: &quot;
+	push_string
+	push 2
+	pcall imprima
+endproc
+// Fim da procedure
+
+endprogram

Added: trunk/gpt2/gptasm/test/gerados_pelo_gptc/procedimentos_definidos_usuario_3.gasm
===================================================================
--- trunk/gpt2/gptasm/test/gerados_pelo_gptc/procedimentos_definidos_usuario_3.gasm	2007-11-19 03:48:19 UTC (rev 373)
+++ trunk/gpt2/gptasm/test/gerados_pelo_gptc/procedimentos_definidos_usuario_3.gasm	2007-11-19 19:53:34 UTC (rev 374)
@@ -0,0 +1,42 @@
+// Programa procedimentos_definidos_usuario_3.gasm gerado a partir de procedimentos_definidos_usuario_3.gpt
+program procedimentos_definidos_usuario_3
+
+var g int
+// Procedure main
+proc main
+	iset g, 0
+	iset g, g
+	push 10
+	push g
+	pcall roda
+	exit 0
+endproc
+// Fim da procedure
+
+// Procedure roda
+proc roda
+	param p1 int
+	param p2 int
+	var l1 int
+	var l2 int
+	iset l1, 0
+	iset l1, l2
+	iset l1, g
+	iset g, l1
+	iset p1, p2
+	iset l1, p1
+	iset p1, l1
+	iset p1, g
+	iset g, p1
+	push l1
+	push_int
+	push p1
+	push_int
+	push g
+	push_int
+	push 3
+	pcall imprima
+endproc
+// Fim da procedure
+
+endprogram

Added: trunk/gpt2/gptasm/test/gerados_pelo_gptc/procedimentos_definidos_usuario_4.gasm
===================================================================
--- trunk/gpt2/gptasm/test/gerados_pelo_gptc/procedimentos_definidos_usuario_4.gasm	2007-11-19 03:48:19 UTC (rev 373)
+++ trunk/gpt2/gptasm/test/gerados_pelo_gptc/procedimentos_definidos_usuario_4.gasm	2007-11-19 19:53:34 UTC (rev 374)
@@ -0,0 +1,34 @@
+// Programa procedimentos_definidos_usuario_4.gasm gerado a partir de procedimentos_definidos_usuario_4.gpt
+program procedimentos_definidos_usuario_4
+
+var x int
+var y int
+// Procedure main
+proc main
+	iset x, 10
+	iset y, 20
+	push 30
+	pcall soma
+	exit 0
+endproc
+// Fim da procedure
+
+// Procedure soma
+proc soma
+	param z int
+	var s int
+	var __temp_1 int
+	var __temp_2 int
+	isum __temp_1, x, y
+	isum __temp_2, __temp_1, z
+	iset s, __temp_2
+	push s
+	push_int
+	push &quot;A soma de x, y e z &#233;: &quot;
+	push_string
+	push 2
+	pcall imprima
+endproc
+// Fim da procedure
+
+endprogram

Added: trunk/gpt2/gptasm/test/gerados_pelo_gptc/variaveis_1.gasm
===================================================================
--- trunk/gpt2/gptasm/test/gerados_pelo_gptc/variaveis_1.gasm	2007-11-19 03:48:19 UTC (rev 373)
+++ trunk/gpt2/gptasm/test/gerados_pelo_gptc/variaveis_1.gasm	2007-11-19 19:53:34 UTC (rev 374)
@@ -0,0 +1,24 @@
+// Programa variaveis_1.gasm gerado a partir de variaveis_1.gpt
+program variaveis_1
+
+var x int
+var y int
+// Procedure main
+proc main
+	var __temp_1 int
+	var __temp_2 int
+	iset x, 10
+	iset y, 20
+	imul __temp_1, x, y
+	isum __temp_2, __temp_1, 4
+	push __temp_2
+	push_int
+	push &quot;x*y+4=&quot;
+	push_string
+	push 2
+	pcall imprima
+	exit 0
+endproc
+// Fim da procedure
+
+endprogram

Added: trunk/gpt2/gptasm/test/gerados_pelo_gptc/variaveis_2.gasm
===================================================================
--- trunk/gpt2/gptasm/test/gerados_pelo_gptc/variaveis_2.gasm	2007-11-19 03:48:19 UTC (rev 373)
+++ trunk/gpt2/gptasm/test/gerados_pelo_gptc/variaveis_2.gasm	2007-11-19 19:53:34 UTC (rev 374)
@@ -0,0 +1,33 @@
+// Programa variaveis_2.gasm gerado a partir de variaveis_2.gpt
+program variaveis_2
+
+var v int
+// Procedure main
+proc main
+	var __temp_1 int
+	var __temp_2 int
+	var __temp_3 int
+	var __temp_4 int
+	iset v, 10
+	iset v, v
+	isum __temp_1, 10, 20
+	iset v, __temp_1
+	isum __temp_2, v, 20
+	iset v, __temp_2
+	isum __temp_3, 30, v
+	iset v, __temp_3
+	isum __temp_4, v, v
+	iset v, __temp_4
+	push 10
+	push_int
+	push 1
+	pcall imprima
+	push v
+	push_int
+	push 1
+	pcall imprima
+	exit 0
+endproc
+// Fim da procedure
+
+endprogram

Added: trunk/gpt2/gptasm/test/gerados_pelo_gptc/variaveis_3.gasm
===================================================================
--- trunk/gpt2/gptasm/test/gerados_pelo_gptc/variaveis_3.gasm	2007-11-19 03:48:19 UTC (rev 373)
+++ trunk/gpt2/gptasm/test/gerados_pelo_gptc/variaveis_3.gasm	2007-11-19 19:53:34 UTC (rev 374)
@@ -0,0 +1,33 @@
+// Programa variaveis_3.gasm gerado a partir de variaveis_3.gpt
+program variaveis_3
+
+var v real
+// Procedure main
+proc main
+	var __temp_1 real
+	var __temp_2 real
+	var __temp_3 real
+	var __temp_4 real
+	rset v, 10.0
+	rset v, v
+	rsum __temp_1, 10.0, 20.0
+	rset v, __temp_1
+	rsum __temp_2, v, 20.0
+	rset v, __temp_2
+	rsum __temp_3, 30.0, v
+	rset v, __temp_3
+	rsum __temp_4, v, v
+	rset v, __temp_4
+	push 10.0
+	push_real
+	push 1
+	pcall imprima
+	push v
+	push_real
+	push 1
+	pcall imprima
+	exit 0
+endproc
+// Fim da procedure
+
+endprogram

Added: trunk/gpt2/gptasm/test/gerados_pelo_gptc/variaveis_4.gasm
===================================================================
--- trunk/gpt2/gptasm/test/gerados_pelo_gptc/variaveis_4.gasm	2007-11-19 03:48:19 UTC (rev 373)
+++ trunk/gpt2/gptasm/test/gerados_pelo_gptc/variaveis_4.gasm	2007-11-19 19:53:34 UTC (rev 374)
@@ -0,0 +1,33 @@
+// Programa variaveis_4.gasm gerado a partir de variaveis_4.gpt
+program variaveis_4
+
+var v char
+// Procedure main
+proc main
+	var __temp_1 char
+	var __temp_2 char
+	var __temp_3 char
+	var __temp_4 char
+	iset v, 'a'
+	iset v, v
+	isum __temp_1, 'a', 'b'
+	iset v, __temp_1
+	isum __temp_2, v, 'b'
+	iset v, __temp_2
+	isum __temp_3, 'c', v
+	iset v, __temp_3
+	isum __temp_4, v, v
+	iset v, __temp_4
+	push 'a'
+	push_char
+	push 1
+	pcall imprima
+	push v
+	push_char
+	push 1
+	pcall imprima
+	exit 0
+endproc
+// Fim da procedure
+
+endprogram

Added: trunk/gpt2/gptasm/test/gerados_pelo_gptc/variaveis_5.gasm
===================================================================
--- trunk/gpt2/gptasm/test/gerados_pelo_gptc/variaveis_5.gasm	2007-11-19 03:48:19 UTC (rev 373)
+++ trunk/gpt2/gptasm/test/gerados_pelo_gptc/variaveis_5.gasm	2007-11-19 19:53:34 UTC (rev 374)
@@ -0,0 +1,33 @@
+// Programa variaveis_5.gasm gerado a partir de variaveis_5.gpt
+program variaveis_5
+
+var v string
+// Procedure main
+proc main
+	var __temp_1 string
+	var __temp_2 string
+	var __temp_3 string
+	var __temp_4 string
+	sset v, &quot;a&quot;
+	sset v, v
+	ssum __temp_1, &quot;a&quot;, &quot;b&quot;
+	sset v, __temp_1
+	ssum __temp_2, v, &quot;b&quot;
+	sset v, __temp_2
+	ssum __temp_3, &quot;c&quot;, v
+	sset v, __temp_3
+	ssum __temp_4, v, v
+	sset v, __temp_4
+	push &quot;aa&quot;
+	push_string
+	push 1
+	pcall imprima
+	push v
+	push_string
+	push 1
+	pcall imprima
+	exit 0
+endproc
+// Fim da procedure
+
+endprogram

Added: trunk/gpt2/gptasm/test/gerados_pelo_gptc/variaveis_6.gasm
===================================================================
--- trunk/gpt2/gptasm/test/gerados_pelo_gptc/variaveis_6.gasm	2007-11-19 03:48:19 UTC (rev 373)
+++ trunk/gpt2/gptasm/test/gerados_pelo_gptc/variaveis_6.gasm	2007-11-19 19:53:34 UTC (rev 374)
@@ -0,0 +1,26 @@
+// Programa variaveis_6.gasm gerado a partir de variaveis_6.gpt
+program variaveis_6
+
+var v bool
+// Procedure main
+proc main
+	iset v, true
+	iset v, false
+	iset v, v
+	push true
+	push_bool
+	push 1
+	pcall imprima
+	push false
+	push_bool
+	push 1
+	pcall imprima
+	push v
+	push_bool
+	push 1
+	pcall imprima
+	exit 0
+endproc
+// Fim da procedure
+
+endprogram

Added: trunk/gpt2/gptasm/test/gerados_pelo_gptc/variaveis_7.gasm
===================================================================
--- trunk/gpt2/gptasm/test/gerados_pelo_gptc/variaveis_7.gasm	2007-11-19 03:48:19 UTC (rev 373)
+++ trunk/gpt2/gptasm/test/gerados_pelo_gptc/variaveis_7.gasm	2007-11-19 19:53:34 UTC (rev 374)
@@ -0,0 +1,26 @@
+// Programa variaveis_7.gasm gerado a partir de variaveis_7.gpt
+program variaveis_7
+
+// Procedure main
+proc main
+	pcall mostra
+	exit 0
+endproc
+// Fim da procedure
+
+// Procedure mostra
+proc mostra
+	var resultado int
+	var __temp_1 int
+	isum __temp_1, 4, 5
+	iset resultado, __temp_1
+	push resultado
+	push_int
+	push &quot;soma de 4 e 5 &#233;: &quot;
+	push_string
+	push 2
+	pcall imprima
+endproc
+// Fim da procedure
+
+endprogram

Added: trunk/gpt2/gptasm/test/gerados_pelo_gptc/variaveis_8.gasm
===================================================================
--- trunk/gpt2/gptasm/test/gerados_pelo_gptc/variaveis_8.gasm	2007-11-19 03:48:19 UTC (rev 373)
+++ trunk/gpt2/gptasm/test/gerados_pelo_gptc/variaveis_8.gasm	2007-11-19 19:53:34 UTC (rev 374)
@@ -0,0 +1,23 @@
+// Programa variaveis_8.gasm gerado a partir de variaveis_8.gpt
+program variaveis_8
+
+var l string
+var c char
+// Procedure main
+proc main
+	sset l, &quot;test1&quot;
+	sset l, '2'
+	iset c, l
+	push l
+	push_string
+	push 1
+	pcall imprima
+	push c
+	push_char
+	push 1
+	pcall imprima
+	exit 0
+endproc
+// Fim da procedure
+
+endprogram

Added: trunk/gpt2/gptasm/test/hello_world.gasm
===================================================================
--- trunk/gpt2/gptasm/test/hello_world.gasm	2007-11-19 03:48:19 UTC (rev 373)
+++ trunk/gpt2/gptasm/test/hello_world.gasm	2007-11-19 19:53:34 UTC (rev 374)
@@ -0,0 +1,14 @@
+program exemplo
+
+proc main
+    push_sp
+    push &quot;Ol&#225; mundo !!!&quot;
+    push_string
+    push 1
+    pcall imprima
+    pop_sp
+
+    exit 0
+endproc
+
+endprogram

Added: trunk/gpt2/gptasm/test/prep_tests.sh
===================================================================
--- trunk/gpt2/gptasm/test/prep_tests.sh	2007-11-19 03:48:19 UTC (rev 373)
+++ trunk/gpt2/gptasm/test/prep_tests.sh	2007-11-19 19:53:34 UTC (rev 374)
@@ -0,0 +1,20 @@
+cd wikki/
+ln -s ../check_all.sh     check_all.sh
+ln -s ../check.sh         check.sh
+ln -s ../asm_all.sh       asm_all.sh
+ln -s ../asm.sh           asm.sh
+ln -s ../show_and_asm.sh  show_and_asm.sh
+ln -s ../test_ok_all.sh   test_ok_all.sh
+ln -s ../test_ok.sh       test_ok.sh
+cd ..
+
+cd gerados_pelo_gptc/
+ln -s ../check_all.sh     check_all.sh
+ln -s ../check.sh         check.sh
+ln -s ../asm_all.sh       asm_all.sh
+ln -s ../asm.sh           asm.sh
+ln -s ../show_and_asm.sh  show_and_asm.sh
+ln -s ../test_ok_all.sh   test_ok_all.sh
+ln -s ../test_ok.sh       test_ok.sh
+cd ..
+


Property changes on: trunk/gpt2/gptasm/test/prep_tests.sh
___________________________________________________________________
Name: svn:executable
   + *

Added: trunk/gpt2/gptasm/test/show_and_asm.sh
===================================================================
--- trunk/gpt2/gptasm/test/show_and_asm.sh	2007-11-19 03:48:19 UTC (rev 373)
+++ trunk/gpt2/gptasm/test/show_and_asm.sh	2007-11-19 19:53:34 UTC (rev 374)
@@ -0,0 +1,17 @@
+echo &quot;ARQUIVO $1.gasm&quot;
+cat $1.gasm
+
+./asm.sh $1
+if [ $? -ne 0 ]
+then
+	exit 1
+fi
+
+echo &quot;&quot;
+
+echo &quot;ARQUIVO $1.gvm&quot;
+cat $1.gvm
+
+#echo &quot;ARQUIVO $1.stdout&quot;
+#cat $1.stdout
+


Property changes on: trunk/gpt2/gptasm/test/show_and_asm.sh
___________________________________________________________________
Name: svn:executable
   + *

Added: trunk/gpt2/gptasm/test/test_ok.sh
===================================================================
--- trunk/gpt2/gptasm/test/test_ok.sh	2007-11-19 03:48:19 UTC (rev 373)
+++ trunk/gpt2/gptasm/test/test_ok.sh	2007-11-19 19:53:34 UTC (rev 374)
@@ -0,0 +1,50 @@
+function exist_file( )
+{
+	if [ -z &quot;$1&quot; ]                    # Checks if parameter #1 is zero length.
+	then
+		echo &quot;-Parameter #1 is zero length.&quot;
+		return 1
+	fi
+
+	if [ &quot;$2&quot; ] # verifica se o parametro existe
+	then
+		echo &quot;-Parameter #2 is \&quot;$2\&quot;.-&quot;
+	fi
+					  
+	if [[ ! -a $1 ]]
+	then
+		echo &quot;Erro: Arquivo $1 nao existe !!!&quot;
+		return 1
+	fi
+
+	return 0
+}
+
+
+exist_file $1.gasm
+if [ $? -ne 0 ]
+then
+	exit 2
+fi
+
+exist_file $1.gvm
+if [ $? -ne 0 ]
+then
+	exit 2
+fi
+
+#exist_file $1.stdout
+#if [ $? -ne 0 ]
+#then
+#	exit 2
+#fi
+
+echo &quot;Copiando o arquivo $1.gasm p/ o diretorio checked&quot;
+cp $1.gasm checked/
+
+echo &quot;Copiando o arquivo $1.gvm p/ o diretorio checked&quot;
+cp $1.gvm  checked/
+
+#echo &quot;Copiando o arquivo $1.stdout p/ o diretorio checked&quot;
+#cp $1.stdout  checked/
+


Property changes on: trunk/gpt2/gptasm/test/test_ok.sh
___________________________________________________________________
Name: svn:executable
   + *

Added: trunk/gpt2/gptasm/test/test_ok_all.sh
===================================================================
--- trunk/gpt2/gptasm/test/test_ok_all.sh	2007-11-19 03:48:19 UTC (rev 373)
+++ trunk/gpt2/gptasm/test/test_ok_all.sh	2007-11-19 19:53:34 UTC (rev 374)
@@ -0,0 +1,7 @@
+echo &quot;Executando test ok para todos os arquivos .gasm do diretorio&quot;
+
+for i in `ls *.gasm -1 | sed s/&quot;\.gasm&quot;//g`
+do
+	./test_ok.sh $i 
+	echo &quot;&quot;
+done


Property changes on: trunk/gpt2/gptasm/test/test_ok_all.sh
___________________________________________________________________
Name: svn:executable
   + *

Added: trunk/gpt2/gptasm/test/wikki/enderecamento_1.gasm
===================================================================
--- trunk/gpt2/gptasm/test/wikki/enderecamento_1.gasm	2007-11-19 03:48:19 UTC (rev 373)
+++ trunk/gpt2/gptasm/test/wikki/enderecamento_1.gasm	2007-11-19 19:53:34 UTC (rev 374)
@@ -0,0 +1,40 @@
+program exemplo
+
+//var c byte[8] // sizeof c
+
+proc main
+    var t1 int
+
+    // c.x := 10;
+    isetv c:0, 10 // *( c + 0 ) := 10
+
+    // c.y := 20;
+    isetv c:4, 20 // *(c + 4 ) := 20
+
+    // imprima( &quot;c.x=&quot;, c.x );
+    push_sp
+    igetv t1, c:0 // t1 := *( c + 0)
+    push t1
+    push_int
+    push &quot;c.x=&quot;
+    push_string
+    push_2
+    pcall imprima
+    pop_sp
+
+    // imprima( &quot;c.y=&quot;, c.y );
+    push_sp
+    igetv t1, c:4 // t1 := *(c + 4)
+    push t1
+    push_int
+    push &quot;c.y=&quot;
+    push_string
+    push_2
+    pcall imprima
+    pop_sp
+
+    exit_0
+endproc
+
+endprogram
+

Added: trunk/gpt2/gptasm/test/wikki/estruturas_condicionais_1.gasm
===================================================================
--- trunk/gpt2/gptasm/test/wikki/estruturas_condicionais_1.gasm	2007-11-19 03:48:19 UTC (rev 373)
+++ trunk/gpt2/gptasm/test/wikki/estruturas_condicionais_1.gasm	2007-11-19 19:53:34 UTC (rev 374)
@@ -0,0 +1,38 @@
+program exemplo
+
+var x int
+
+proc main
+    var t1 int
+
+    // x := 10;
+    iset x, 10
+
+    // se x &gt;= 20 entao
+    ige t1, x, 20
+    ifnot t1, senao
+
+    // x := 2;
+    iset x, 2
+
+    jmp proximo
+    senao:
+
+    // x := 1;
+    iset x, 1
+
+    proximo:
+
+    // imprima( x );
+    push_sp
+    push x
+    push_int
+    push_1
+    pcall imprima
+    pop_sp
+
+    exit_0
+endproc
+
+endprogram
+

Added: trunk/gpt2/gptasm/test/wikki/estruturas_repeticao_1.gasm
===================================================================
--- trunk/gpt2/gptasm/test/wikki/estruturas_repeticao_1.gasm	2007-11-19 03:48:19 UTC (rev 373)
+++ trunk/gpt2/gptasm/test/wikki/estruturas_repeticao_1.gasm	2007-11-19 19:53:34 UTC (rev 374)
@@ -0,0 +1,32 @@
+program exemplo
+
+var x int
+
+proc main
+    var t1 int
+
+    // para x de 1 at&#233; 10 fa&#231;a
+    iset x, 1
+    teste:
+    ile t1, x, 10
+    ifnot t1, proximo
+
+    // imprima( x );
+    push_sp
+    push x
+    push_int
+    push_1
+    pcall imprima
+    pop_sp
+
+    // fim-para
+    iinc x, 1
+    jmp teste
+
+    proximo:
+
+    exit_0
+endproc
+
+endprogram
+

Added: trunk/gpt2/gptasm/test/wikki/expressoes_matematicas_1.gasm
===================================================================
--- trunk/gpt2/gptasm/test/wikki/expressoes_matematicas_1.gasm	2007-11-19 03:48:19 UTC (rev 373)
+++ trunk/gpt2/gptasm/test/wikki/expressoes_matematicas_1.gasm	2007-11-19 19:53:34 UTC (rev 374)
@@ -0,0 +1,22 @@
+program exemplo
+
+proc main
+    var t1 int
+    var t2 int
+
+    // imprima( &quot;2+5*3=&quot;, 2+5*3 );
+    push_sp
+    imul t1, 5, 3
+    isum t2, 2, t1
+    push t2
+    push_int
+    push &quot;2+5*3=&quot;
+    push_string
+    push_2
+    pcall imprima
+    pop_sp
+
+    exit_0
+endproc
+
+endprogram

Added: trunk/gpt2/gptasm/test/wikki/funcoes_definidas_usuario_1.gasm
===================================================================
--- trunk/gpt2/gptasm/test/wikki/funcoes_definidas_usuario_1.gasm	2007-11-19 03:48:19 UTC (rev 373)
+++ trunk/gpt2/gptasm/test/wikki/funcoes_definidas_usuario_1.gasm	2007-11-19 19:53:34 UTC (rev 374)
@@ -0,0 +1,31 @@
+program exemplo
+
+proc main
+    // imprima( &quot;A soma &#233;: &quot;, soma( 2, 7 ) );
+    push_sp
+    push_0 // resultado da fun&#231;&#227;o
+    push 7 // empilha 7
+    push 2 // empilha 2
+    pcall soma
+    push_int
+    push &quot;A soma &#233;: &quot;
+    push_string
+    push_2
+    pcall imprima
+    pop_sp
+	
+    exit_0
+endproc
+
+proc soma
+    param __result int
+    param x int
+    param y int
+
+    isum __result, x, y
+
+    ret
+endproc
+
+endprogram
+

Added: trunk/gpt2/gptasm/test/wikki/invocando_subrotinas_linguagem_1.gasm
===================================================================
--- trunk/gpt2/gptasm/test/wikki/invocando_subrotinas_linguagem_1.gasm	2007-11-19 03:48:19 UTC (rev 373)
+++ trunk/gpt2/gptasm/test/wikki/invocando_subrotinas_linguagem_1.gasm	2007-11-19 19:53:34 UTC (rev 374)
@@ -0,0 +1,14 @@
+program exemplo
+
+proc main
+    push_sp
+    push &quot;Ol&#225; mundo !!!&quot;
+    push_string
+    push_1
+    pcall imprima
+    pop_sp
+
+    exit_0
+endproc
+
+endprogram

Added: trunk/gpt2/gptasm/test/wikki/invocando_subrotinas_linguagem_2.gasm
===================================================================
--- trunk/gpt2/gptasm/test/wikki/invocando_subrotinas_linguagem_2.gasm	2007-11-19 03:48:19 UTC (rev 373)
+++ trunk/gpt2/gptasm/test/wikki/invocando_subrotinas_linguagem_2.gasm	2007-11-19 19:53:34 UTC (rev 374)
@@ -0,0 +1,33 @@
+program exemplo
+
+var x int
+
+proc main
+    // imprima( &quot;Digite um n&#250;mero: &quot; );
+    push_sp
+    push &quot;Digite um n&#250;mero: &quot;
+    push_string
+    push_1
+    pcall imprima
+    pop_sp
+    // x := leia( );
+    push_0 // resultado da fun&#231;&#227;o
+    push_sp
+    pcall leia
+    pop_sp
+    pop x
+    // imprima( &quot;O n&#250;mero digitado foi &quot;, x );
+    push_sp
+    push x
+    push_int
+    push &quot;O n&#250;mero digitado foi &quot;
+    push_string
+    push_2
+    pcall imprima
+    pop_sp
+
+    exit_0
+endproc
+
+endprogram
+

Added: trunk/gpt2/gptasm/test/wikki/procedimentos_definidos_usuario_1.gasm
===================================================================
--- trunk/gpt2/gptasm/test/wikki/procedimentos_definidos_usuario_1.gasm	2007-11-19 03:48:19 UTC (rev 373)
+++ trunk/gpt2/gptasm/test/wikki/procedimentos_definidos_usuario_1.gasm	2007-11-19 19:53:34 UTC (rev 374)
@@ -0,0 +1,39 @@
+program exemplo
+
+proc main
+    // soma( 2, 7 );
+    push_sp
+    push 7
+    push 2
+    pcall soma
+    pop_sp
+	
+    exit_0
+endproc
+
+proc soma
+    param x int
+    param y int
+
+    var t1 int
+
+    push_sp
+    push &quot;A soma &#233;: &quot;
+    push_string
+    push_1
+    pcall imprima
+    pop_sp
+
+    push_sp
+    isum t1, x, y
+    push t1
+    push_int
+    push_1
+    pcall imprima
+    pop_sp
+
+    ret	
+endproc
+
+endprogram
+

Added: trunk/gpt2/gptasm/test/wikki/procedimentos_definidos_usuario_2.gasm
===================================================================
--- trunk/gpt2/gptasm/test/wikki/procedimentos_definidos_usuario_2.gasm	2007-11-19 03:48:19 UTC (rev 373)
+++ trunk/gpt2/gptasm/test/wikki/procedimentos_definidos_usuario_2.gasm	2007-11-19 19:53:34 UTC (rev 374)
@@ -0,0 +1,38 @@
+program exemplo
+
+var s int
+
+proc main
+    // soma( s, 2, 7 );
+    push_sp
+    push 7
+    push 2
+    push s
+    pcall soma
+    pop_sp
+	
+    // imprima( s );
+    push_sp
+    push s
+    push_int
+    push_1
+    pcall imprima
+    pop_sp
+	
+    exit_0
+endproc
+
+proc soma
+    param r int
+    param v1 int
+    param v2 int
+
+    // r := v1 + v2;
+    isum t1, v1, v2
+    isetv r:0, t1
+
+    ret	
+endproc
+
+endprogram
+

Added: trunk/gpt2/gptasm/test/wikki/variaveis_1.gasm
===================================================================
--- trunk/gpt2/gptasm/test/wikki/variaveis_1.gasm	2007-11-19 03:48:19 UTC (rev 373)
+++ trunk/gpt2/gptasm/test/wikki/variaveis_1.gasm	2007-11-19 19:53:34 UTC (rev 374)
@@ -0,0 +1,32 @@
+program exemplo
+
+var x int
+var y int
+
+proc main
+    var t1 int
+    var t2 int
+
+    // x := 10;
+    iset x, 10
+	
+    // y := 20;
+    iset y, 20
+	
+    // imprima( &quot;x*y+4=&quot;, x*y+4 );
+    push_sp
+    imul t1, x, y
+    isum t2, t1, 4
+    push t2
+    push_int
+    push &quot;x*y+4&quot;
+    push_string
+    push_2
+    pcall imprima
+    pop_sp
+	
+    exit_0
+endproc
+
+endprogram
+

Added: trunk/gpt2/gptasm/test/wikki/variaveis_2.gasm
===================================================================
--- trunk/gpt2/gptasm/test/wikki/variaveis_2.gasm	2007-11-19 03:48:19 UTC (rev 373)
+++ trunk/gpt2/gptasm/test/wikki/variaveis_2.gasm	2007-11-19 19:53:34 UTC (rev 374)
@@ -0,0 +1,31 @@
+program exemplo
+
+var v int
+
+proc main
+    iset v, 0
+    iset v, v
+    isum v, 10, 10
+    isum v, v, v
+    isum v, v, 10
+    isum v, 10, v
+
+    push_sp
+    push v
+    push_int
+    push_1
+    pcall imprima
+    pop_sp
+	
+    push_sp
+    push 10
+    push_int
+    push_1
+    pcall imprima
+    pop_sp
+	
+    exit_0
+endproc
+
+endprogram
+

Added: trunk/gpt2/gptasm/test/wikki/variaveis_3.gasm
===================================================================
--- trunk/gpt2/gptasm/test/wikki/variaveis_3.gasm	2007-11-19 03:48:19 UTC (rev 373)
+++ trunk/gpt2/gptasm/test/wikki/variaveis_3.gasm	2007-11-19 19:53:34 UTC (rev 374)
@@ -0,0 +1,31 @@
+program exemplo
+
+var v real
+
+proc main
+    rset v, 0.0
+    rset v, v
+    rsum v, 10.0, 10.0
+    rsum v, v, v
+    rsum v, v, 10.0
+    rsum v, 10.0, v
+
+    push_sp
+    push v
+    push_real
+    push_1
+    pcall imprima
+    pop_sp
+
+    push_sp
+    push 10.0
+    push_real
+    push_1
+    pcall imprima
+    pop_sp
+
+    exit_0
+endproc
+
+endprogram
+

Added: trunk/gpt2/gptasm/test/wikki/variaveis_4.gasm
===================================================================
--- trunk/gpt2/gptasm/test/wikki/variaveis_4.gasm	2007-11-19 03:48:19 UTC (rev 373)
+++ trunk/gpt2/gptasm/test/wikki/variaveis_4.gasm	2007-11-19 19:53:34 UTC (rev 374)
@@ -0,0 +1,35 @@
+program exemplo
+
+var v string
+
+proc main
+    salloc v
+
+    sset v, &quot;0&quot;
+    sset v, v
+    ssum v, &quot;10&quot;, &quot;10&quot;
+    ssum v, v, v
+    ssum v, v, &quot;10&quot;
+    ssum v, &quot;10&quot;, v
+
+    push_sp
+    push v
+    push_string
+    push_1
+    pcall imprima
+    pop_sp
+	
+    push_sp
+    push &quot;10&quot;
+    push_string
+    push_1
+    pcall imprima
+    pop_sp
+	
+    sfree v
+
+    exit_0
+endproc
+
+endprogram
+

Added: trunk/gpt2/gptasm/test/wikki/variaveis_5.gasm
===================================================================
--- trunk/gpt2/gptasm/test/wikki/variaveis_5.gasm	2007-11-19 03:48:19 UTC (rev 373)
+++ trunk/gpt2/gptasm/test/wikki/variaveis_5.gasm	2007-11-19 19:53:34 UTC (rev 374)
@@ -0,0 +1,31 @@
+program exemplo
+
+var v char
+
+proc main
+    iset v, 'a'
+    iset v, v
+    isum v, 'a', 'b'
+    isum v, v, v
+    isum v, v, 'a'
+    isum v, 'b', v
+
+    push_sp
+    push v
+    push_char
+    push_1
+    pcall imprima
+    pop_sp
+
+    push_sp
+    push 'a'
+    push_char
+    push_1
+    pcall imprima
+    pop_sp
+
+    exit_0
+endproc
+
+endprogram
+

Added: trunk/gpt2/gptasm/test/wikki/variaveis_6.gasm
===================================================================
--- trunk/gpt2/gptasm/test/wikki/variaveis_6.gasm	2007-11-19 03:48:19 UTC (rev 373)
+++ trunk/gpt2/gptasm/test/wikki/variaveis_6.gasm	2007-11-19 19:53:34 UTC (rev 374)
@@ -0,0 +1,35 @@
+program exemplo
+
+var v bool
+
+proc main
+    iset v, true
+    iset v, false
+    iset v, v
+
+    push_sp
+    push true
+    push_bool
+    push_1
+    pcall imprima
+    pop_sp
+
+    push_sp
+    push false
+    push_bool
+    push_1
+    pcall imprima
+    pop_sp
+
+    push_sp
+    push v
+    push_bool
+    push_1
+    pcall imprima
+    pop_sp
+
+    exit_0
+endproc
+
+endprogram
+

Added: trunk/gpt2/gptvm/src/CDataStack.cpp
===================================================================
--- trunk/gpt2/gptvm/src/CDataStack.cpp	2007-11-19 03:48:19 UTC (rev 373)
+++ trunk/gpt2/gptvm/src/CDataStack.cpp	2007-11-19 19:53:34 UTC (rev 374)
@@ -0,0 +1,12 @@
+#include &quot;CDataStack.hpp&quot;
+
+
+CDataStack::CDataStack()
+{
+}
+
+
+CDataStack::~CDataStack()
+{
+}
+

Added: trunk/gpt2/gptvm/src/CDataStack.hpp
===================================================================
--- trunk/gpt2/gptvm/src/CDataStack.hpp	2007-11-19 03:48:19 UTC (rev 373)
+++ trunk/gpt2/gptvm/src/CDataStack.hpp	2007-11-19 19:53:34 UTC (rev 374)
@@ -0,0 +1,17 @@
+#ifndef GPT_DATA_STACK_H
+#define GPT_DATA_STACK_H
+
+
+#include &lt;stack&gt;
+
+
+class CDataStack : public std::stack&lt;void*&gt;
+{
+public:
+   CDataStack();
+   ~CDataStack();
+private:
+};
+
+#endif
+

Added: trunk/gpt2/gptvm/src/CGptVm.cpp
===================================================================
--- trunk/gpt2/gptvm/src/CGptVm.cpp	2007-11-19 03:48:19 UTC (rev 373)
+++ trunk/gpt2/gptvm/src/CGptVm.cpp	2007-11-19 19:53:34 UTC (rev 374)
@@ -0,0 +1,20 @@
+#include &lt;fstream&gt;
+
+#include &quot;CGptVm.hpp&quot;
+#include &quot;CRunBytecode.hpp&quot;
+
+
+CGptVm::CGptVm( COptions *options ) : _options( options )
+{
+}
+
+
+bool CGptVm::run( )
+{
+   ifstream in(_options-&gt;sourcefile.c_str(),ios::in | ios::binary);
+
+   CRunBytecode bytecode;
+
+   return bytecode.readFromFile(in) &amp;&amp; bytecode.run();
+}
+

Added: trunk/gpt2/gptvm/src/CGptVm.hpp
===================================================================
--- trunk/gpt2/gptvm/src/CGptVm.hpp	2007-11-19 03:48:19 UTC (rev 373)
+++ trunk/gpt2/gptvm/src/CGptVm.hpp	2007-11-19 19:53:34 UTC (rev 374)
@@ -0,0 +1,18 @@
+#ifndef GPT_CGPT_VM_H
+#define GPT_CGPT_VM_H
+
+
+#include &quot;COptions.hpp&quot;
+
+
+class CGptVm
+{
+public:
+   CGptVm( COptions *options );
+   bool run( );
+private:
+   COptions *_options;
+};
+
+#endif
+

Added: trunk/gpt2/gptvm/src/CRunBytecode.cpp
===================================================================
--- trunk/gpt2/gptvm/src/CRunBytecode.cpp	2007-11-19 03:48:19 UTC (rev 373)
+++ trunk/gpt2/gptvm/src/CRunBytecode.cpp	2007-11-19 19:53:34 UTC (rev 374)
@@ -0,0 +1,390 @@
+#include &quot;CRunBytecode.hpp&quot;
+
+#include &lt;sstream&gt;
+#include &lt;iostream&gt;
+
+
+CRunBytecode::CRunBytecode()
+{
+}
+
+
+CRunBytecode::~CRunBytecode()
+{
+}
+
+
+bool CRunBytecode::readFromFile(std::ifstream &amp;in)
+{
+   std::stringstream buf;
+   buf &lt;&lt; in.rdbuf();
+   CBinString bin;
+   bin.assign(buf.str());
+
+   return _header.readFromBinary(bin) &amp;&amp;
+          _symbolTable.readFromBinary(bin) &amp;&amp;
+          _data.readFromBinary(bin) &amp;&amp;
+          _code.readFromBinary(bin);
+}
+
+void CRunBytecode::initOpcodePointer()
+{
+   for (int i = 0; i &lt; OPCODE_NUMBER; i++) {
+      _opcodePointer[i] = &amp;CRunBytecode::invalidOpcode;
+   }
+
+   _opcodePointer[OP_NOP         ] = &amp;CRunBytecode::nopOpcode;
+   _opcodePointer[OP_PUSH_SP     ] = &amp;CRunBytecode::pushSpOpcode;
+   _opcodePointer[OP_POP_SP      ] = &amp;CRunBytecode::popSpOpcode;
+   _opcodePointer[OP_PUSH        ] = &amp;CRunBytecode::pushOpcode;
+   _opcodePointer[OP_PUSH_STRING ] = &amp;CRunBytecode::pushStringOpcode;
+//   _opcodePointer[OP_PUSH_1      ] = &amp;CRunBytecode::push1Opcode;
+   _opcodePointer[OP_PCALL       ] = &amp;CRunBytecode::pcallOpcode;
+//   _opcodePointer[OP_EXIT_0      ] = &amp;CRunBytecode::exit0Opcode;
+   _opcodePointer[OP_EXIT        ] = &amp;CRunBytecode::exitOpcode;
+
+//   OP_EXIT_1,
+// _opcodePointer[OP_HLT         ] = &amp;CRunBytecode::hltOpcode;
+
+   _opcodePointer[OP_ISUM        ] = &amp;CRunBytecode::isumOpcode;
+//   _opcodePointer[OP_SSUM        ] = &amp;CRunBytecode::ssumOpcode;
+//   _opcodePointer[OP_RSUM        ] = &amp;CRunBytecode::rsumOpcode;
+//   _opcodePointer[OP_ISUB        ] = &amp;CRunBytecode::isubOpcode;
+//   _opcodePointer[OP_SSUB        ] = &amp;CRunBytecode::ssubOpcode;
+//   _opcodePointer[OP_RSUB        ] = &amp;CRunBytecode::rsubOpcode;
+   _opcodePointer[OP_IMUL        ] = &amp;CRunBytecode::imulOpcode;
+//   _opcodePointer[OP_RMUL        ] = &amp;CRunBytecode::rmulOpcode;
+/*
+   OP_IDIV,
+   OP_RDIV,
+   OP_IMOD,
+   OP_RMOD,
+   OP_IGE,
+   OP_SGE,
+   OP_RGE,
+   OP_ILE,
+   OP_SLE,
+   OP_RLE,
+   OP_INE,
+   OP_SNE,
+   OP_RNE,
+   OP_IGT,
+   OP_SGT,
+   OP_RGT,
+   OP_ILT,
+   OP_SLT,
+   OP_RLT,
+   OP_IEQ,
+   OP_SEQ,
+   OP_REQ,
+   OP_OR,
+   OP_AND,
+   OP_XOR,
+   OP_INEG,
+   OP_RNEG,
+   OP_NOT,
+   OP_IINC,
+   OP_IDEC,
+   OP_I2C,
+   OP_R2C,
+   OP_S2C,
+   OP_B2C,
+   OP_I2R,
+   OP_C2R,
+   OP_S2R,
+   OP_B2R,
+   OP_I2B,
+   OP_C2B,
+   OP_R2B,
+   OP_S2B,
+   OP_I2S,
+   OP_C2S,
+   OP_R2S,
+   OP_B2S,
+   OP_P2S,
+   OP_C2I,
+   OP_R2I,
+   OP_S2I,
+   OP_B2I,
+*/
+   _opcodePointer[OP_ISET        ] = &amp;CRunBytecode::isetOpcode;
+/*
+   OP_SSET,
+   OP_RSET,
+   OP_GETA,
+   OP_IGETV,
+   OP_SGETV,
+   OP_RGETV,
+   OP_ISETV,
+   OP_SSETV,
+   OP_RSETV,
+   OP_JMP,
+   OP_IF,
+   OP_IFNOT,
+   OP_POP,
+   OP_INCSP,
+   OP_DECSP,
+   OP_PUSH_0,
+   OP_PUSH_2,
+   OP_PUSH_3,
+   OP_PUSH_4,
+   OP_PUSH_5,
+*/
+   _opcodePointer[OP_PUSH_INT      ] = &amp;CRunBytecode::pushIntOpcode;
+   _opcodePointer[OP_PUSH_REAL     ] = &amp;CRunBytecode::pushRealOpcode;
+   _opcodePointer[OP_PUSH_CHAR     ] = &amp;CRunBytecode::pushCharOpcode;
+   _opcodePointer[OP_PUSH_BOOL     ] = &amp;CRunBytecode::pushBoolOpcode;
+/*
+   OP_PUSH_MATRIX,
+   OP_INCSP_4,
+   OP_INCSP_8,
+   OP_DECSP_4,
+   OP_DECSP_8,
+   OP_RET,
+   OP_SALLOC,
+   OP_SFREE,
+   OP_SSETC,
+   OP_SGETC,
+   OP_M1ALLOC,
+   OP_M2ALLOC,
+   OP_MFREE,
+   OP_M1SET,
+   OP_M1GET,
+   OP_M2SET,
+   OP_M2GET,
+   OP_MCOPY,
+   OP_MGETSIZE1,
+   OP_MGETSIZE2,
+*/
+}
+
+
+bool CRunBytecode::run()
+{
+//   std::cout &lt;&lt; &quot;Code lido: [&quot; &lt;&lt; _code.getBinary() &lt;&lt; &quot;]&quot; &lt;&lt; &quot; size=&quot; &lt;&lt; _code.getBinary().size() &lt;&lt; std::endl;
+
+   initOpcodePointer();
+   _IP = 0;
+   _stop = false;
+
+   while (!_stop) {
+      step();
+   }
+
+   return true;
+}
+
+void CRunBytecode::step()
+{
+    char opcode;
+    opcode = _code.getByte(_IP);
+    _IP++;
+
+   if (opcode &gt;= OPCODE_NUMBER) {
+      error( &quot;Invalid opcode !!!&quot; );
+   }
+
+    (this-&gt;*_opcodePointer[(int)opcode]) ( );
+}
+
+void CRunBytecode::trace(const std::string &amp;message)
+{
+   //std::cout &lt;&lt; message &lt;&lt; std::endl;
+}
+
+void CRunBytecode::error(const std::string &amp;message)
+{
+   std::cerr &lt;&lt; message &lt;&lt; std::endl;
+   abort();
+}
+
+void CRunBytecode::procImprima()
+{
+   int argNumber = _data.getInt((int)_dataStack.top());
+   _dataStack.pop();
+
+   for (int arg=0; arg &lt; argNumber; arg++) {
+      int type = (int)_dataStack.top();
+      _dataStack.pop();
+      int address = (int)_dataStack.top();
+      _dataStack.pop();
+      int value;
+      switch (type) {
+         case CSymbol::STRING:
+            std::cout &lt;&lt; _data.getString(address);
+            break;
+         case CSymbol::INT:
+            std::cout &lt;&lt; _data.getInt(address);
+            break;
+         case CSymbol::CHAR:
+            std::cout &lt;&lt; (char)_data.getInt(address);
+            break;
+         case CSymbol::BOOL:
+            value = _data.getInt(address);
+            if (value == 0) {
+               std::cout &lt;&lt; &quot;false&quot;;
+            } else {
+               std::cout &lt;&lt; &quot;true&quot;;
+            }
+            break;
+         case CSymbol::REAL:
+         case CSymbol::MATRIX:
+         default:
+            std::cout &lt;&lt; &quot;Tipo nao suportado !!!&quot; &lt;&lt; std::endl;
+            abort();
+      }
+   }
+   std::cout &lt;&lt; std::endl;
+}
+
+// opcodes
+
+void CRunBytecode::invalidOpcode()
+{
+   error (&quot;Invalid opcode !!!&quot;);
+}
+
+void CRunBytecode::nopOpcode()
+{
+//   trace (&quot;nop opcode&quot;);
+   invalidOpcode();
+
+    //nothing to do
+}
+
+void CRunBytecode::pushSpOpcode()
+{
+   trace (&quot;push_sp opcode&quot;);
+   // TODO
+}
+
+void CRunBytecode::popSpOpcode()
+{
+   trace (&quot;pop_sp opcode&quot;);
+   // TODO
+}
+
+void CRunBytecode::pushOpcode()
+{
+   trace (&quot;push opcode&quot;);
+
+   int address = _code.getInt(_IP);
+   _IP += sizeof(int);
+   _dataStack.push((void*)address);
+}
+
+void CRunBytecode::pushStringOpcode()
+{
+   trace (&quot;push_string opcode&quot;);
+
+   _dataStack.push((void*)CSymbol::STRING);
+}
+
+void CRunBytecode::pushIntOpcode()
+{
+   trace (&quot;push_int opcode&quot;);
+
+   _dataStack.push((void*)CSymbol::INT);
+}
+
+void CRunBytecode::pushBoolOpcode()
+{
+   trace (&quot;push_bool opcode&quot;);
+
+   _dataStack.push((void*)CSymbol::BOOL);
+}
+
+void CRunBytecode::pushRealOpcode()
+{
+   trace (&quot;push_real opcode&quot;);
+
+   _dataStack.push((void*)CSymbol::REAL);
+}
+
+void CRunBytecode::pushCharOpcode()
+{
+   trace (&quot;push_char opcode&quot;);
+
+   _dataStack.push((void*)CSymbol::CHAR);
+}
+
+void CRunBytecode::push1Opcode()
+{
+   trace (&quot;push_1 opcode&quot;);
+
+   _dataStack.push((void*)1);
+}
+
+void CRunBytecode::pcallOpcode()
+{
+   trace (&quot;pcall opcode&quot;);
+
+   int address = _code.getInt(_IP);
+   _IP += sizeof(int);
+
+   std::string temp = _data.getString(address);
+
+   if (_data.getString(address) == &quot;imprima&quot;) {
+      procImprima();
+   }
+}
+
+
+void CRunBytecode::exitOpcode()
+{
+   trace (&quot;exit opcode&quot;);
+
+   int returnCode = _code.getInt(_IP); // TODO
+   _IP += sizeof(int);
+
+   _stop = true;
+}
+
+
+void CRunBytecode::isetOpcode()
+{
+   trace (&quot;iset opcode&quot;);
+
+   int varAddress = _code.getInt(_IP);
+   _IP += sizeof(int);
+
+   int valAddress = _code.getInt(_IP);
+   _IP += sizeof(int);
+
+   _data.setInt(varAddress, _data.getInt(valAddress));
+}
+
+
+void CRunBytecode::isumOpcode()
+{
+   trace (&quot;isum opcode&quot;);
+
+   int varAddress = _code.getInt(_IP);
+   _IP += sizeof(int);
+
+   int val1Address = _code.getInt(_IP);
+   _IP += sizeof(int);
+
+   int val2Address = _code.getInt(_IP);
+   _IP += sizeof(int);
+
+   _data.setInt(varAddress, _data.getInt(val1Address) + _data.getInt(val2Address));
+}
+
+
+void CRunBytecode::imulOpcode()
+{
+   trace (&quot;imul opcode&quot;);
+
+   int varAddress = _code.getInt(_IP);
+   _IP += sizeof(int);
+
+   int val1Address = _code.getInt(_IP);
+   _IP += sizeof(int);
+
+   int val2Address = _code.getInt(_IP);
+   _IP += sizeof(int);
+
+   _data.setInt(varAddress, _data.getInt(val1Address) * _data.getInt(val2Address));
+}
+

Added: trunk/gpt2/gptvm/src/CRunBytecode.hpp
===================================================================
--- trunk/gpt2/gptvm/src/CRunBytecode.hpp	2007-11-19 03:48:19 UTC (rev 373)
+++ trunk/gpt2/gptvm/src/CRunBytecode.hpp	2007-11-19 19:53:34 UTC (rev 374)
@@ -0,0 +1,64 @@
+#ifndef GPT_RUN_BYTECODE_H
+#define GPT_RUN_BYTECODE_H
+
+#include &lt;string&gt;
+#include &lt;vector&gt;
+#include &lt;fstream&gt;
+
+#include &quot;CHeader.hpp&quot;
+#include &quot;CSymbolTable.hpp&quot;
+#include &quot;CData.hpp&quot;
+#include &quot;CCode.hpp&quot;
+#include &quot;Common.hpp&quot;
+#include &quot;CDataStack.hpp&quot;
+
+class CRunBytecode;
+
+typedef void (CRunBytecode:: *OpcodePointer) ( );
+
+
+class CRunBytecode
+{
+public:
+   CRunBytecode();
+   ~CRunBytecode();
+   bool readFromFile(std::ifstream &amp;in);
+   bool run();
+private:
+   void trace(const std::string &amp;message);
+   void error(const std::string &amp;message);
+   void initOpcodePointer();
+   void step();
+   void procImprima();
+   // opcodes
+   void invalidOpcode();
+   void nopOpcode();
+   void pushSpOpcode();
+   void popSpOpcode();
+   void pushOpcode();
+   void pushStringOpcode();
+   void pushIntOpcode();
+   void pushRealOpcode();
+   void pushBoolOpcode();
+   void pushCharOpcode();
+   void push1Opcode();
+   void pcallOpcode();
+//   void exit0Opcode();
+   void exitOpcode();
+   void isetOpcode();
+   void isumOpcode();
+   void imulOpcode();
+
+
+   CHeader       _header;
+   CSymbolTable  _symbolTable;
+   CData         _data;
+   CCode         _code;
+   OpcodePointer _opcodePointer[ OPCODE_NUMBER ];
+   int           _IP;
+   bool          _stop;
+   CDataStack    _dataStack;
+};
+
+#endif
+

Added: trunk/gpt2/gptvm/src/Makefile
===================================================================
--- trunk/gpt2/gptvm/src/Makefile	2007-11-19 03:48:19 UTC (rev 373)
+++ trunk/gpt2/gptvm/src/Makefile	2007-11-19 19:53:34 UTC (rev 374)
@@ -0,0 +1,26 @@
+COMMON_DIR=../../common/src/
+
+INCLUDE_DIR=-I$(COMMON_DIR)
+CC=g++
+CCFLAGS=-g -Wall
+
+GPTASM=../gptasm/
+
+objects = main.o CGptVm.o CRunBytecode.o CDataStack.o \
+          $(COMMON_DIR)CSymbol.o $(COMMON_DIR)CSymbolTable.o $(COMMON_DIR)CCode.o  \
+          $(COMMON_DIR)CHeader.o $(COMMON_DIR)CData.o       \
+          $(COMMON_DIR)CBinString.o $(COMMON_DIR)CSymbolList.o 
+          
+
+all: $(objects)
+	g++ -o gptvm $(objects)
+
+%.o: %.cpp %.hpp
+	$(CC) $(CCFLAGS) -c $(INCLUDE_DIR) $&lt; -o $@
+
+%.o: %.cpp
+	$(CC) $(CCFLAGS) -c $(INCLUDE_DIR) $&lt; -o $@
+
+
+clean:
+	rm -f *.o $(COMMON_DIR)*.o gptvm

Added: trunk/gpt2/gptvm/src/main.cpp
===================================================================
--- trunk/gpt2/gptvm/src/main.cpp	2007-11-19 03:48:19 UTC (rev 373)
+++ trunk/gpt2/gptvm/src/main.cpp	2007-11-19 19:53:34 UTC (rev 374)
@@ -0,0 +1,66 @@
+#include &lt;iostream&gt;
+#include &lt;string&gt;
+
+using namespace std;
+
+#include &quot;COptions.hpp&quot;
+#include &quot;CGptVm.hpp&quot;
+
+
+void showSyntax();
+
+
+int main (int argc, char *argv[])
+{
+   int i;
+   COptions options;
+
+   cout &lt;&lt; &quot;GptVM, release 0.1.0 (development release)&quot; &lt;&lt; endl;
+
+   while ((i = getopt(argc, argv, &quot;h&quot;)) != -1) {
+      switch (i) {
+         case 'h':
+            showSyntax();
+            return EXIT_SUCCESS;
+            break;
+         default:
+            break;
+      }
+   }
+
+   argc -= optind;
+   argv += optind;
+
+   if (argc &lt; 1) {
+      showSyntax();
+      return EXIT_FAILURE;
+   }
+
+   options.sourcefile = string(argv[0]) + &quot;.gvm&quot;;
+
+//   cout &lt;&lt; &quot;Running &quot; &lt;&lt; options.sourcefile &lt;&lt; &quot;...&quot; &lt;&lt; endl;
+
+   CGptVm gptvm( &amp;options );
+
+   if (gptvm.run()) {
+//      cout &lt;&lt; &quot;Program &quot; &lt;&lt; options.sourcefile &lt;&lt; &quot; ok !!!&quot; &lt;&lt; endl &lt;&lt; endl;
+   } else {
+//      cout &lt;&lt; &quot;Program &quot; &lt;&lt; options.sourcefile &lt;&lt; &quot; has errors...&quot; &lt;&lt; endl &lt;&lt; endl;
+      exit( EXIT_FAILURE );
+   }
+
+   return EXIT_SUCCESS;
+}
+
+
+void showSyntax() {
+   cout &lt;&lt; endl 
+        &lt;&lt; &quot;Desenvolvido por XXX, YYY e ZZZ&quot; &lt;&lt; endl 
+        &lt;&lt; &quot;Novembro, 2007&quot; &lt;&lt; endl 
+        &lt;&lt; endl 
+        &lt;&lt; &quot;Syntax: gptvm [options] file&quot; &lt;&lt; endl 
+        &lt;&lt; &quot;Options:&quot; &lt;&lt; endl 
+        &lt;&lt; &quot;         -h help&quot; &lt;&lt; endl 
+        &lt;&lt; endl;
+}
+

Added: trunk/gpt2/gptvm/test/check.sh
===================================================================
--- trunk/gpt2/gptvm/test/check.sh	2007-11-19 03:48:19 UTC (rev 373)
+++ trunk/gpt2/gptvm/test/check.sh	2007-11-19 19:53:34 UTC (rev 374)
@@ -0,0 +1,68 @@
+function exist_file( )
+{
+	if [ -z &quot;$1&quot; ]                    # Checks if parameter #1 is zero length.
+	then
+		echo &quot;-Parameter #1 is zero length.&quot;
+		return 1
+	fi
+
+	if [ &quot;$2&quot; ] # verifica se o parametro existe
+	then
+		echo &quot;-Parameter #2 is \&quot;$2\&quot;.-&quot;
+	fi
+					  
+	if [[ ! -a $1 ]]
+	then
+		echo &quot;Erro: Arquivo $1 nao existe !!!&quot;
+		return 1
+	fi
+
+	return 0
+}
+
+echo &quot;Realizando o teste regressivo no arquivo $1.gvm&quot;
+
+exist_file $1.gvm
+if [ $? -ne 0 ]
+then
+	exit 2
+fi
+
+exist_file checked/$1.gvm
+if [ $? -ne 0 ]
+then
+	exit 2
+fi
+
+exist_file checked/$1.stdout
+if [ $? -ne 0 ]
+then
+	exit 2
+fi
+
+diff $1.gvm checked/$1.gvm &gt;/dev/null 2&gt;&amp;1
+if [ $? -ne 0 ]
+then
+	echo &quot;Erro: Os arquivos $1.gvm e checked/$1.gvm sao diferentes. Nao eh possivel realizar o teste regressivo !&quot;
+	exit 2
+fi
+
+./run.sh $1
+if [ $? -ne 0 ]
+then
+	echo &quot;Erro: Arquivo $1.gvm nao foi executado corretamente&quot;
+	exit 2
+fi
+
+diff $1.stdout checked/$1.stdout &gt;/dev/null 2&gt;&amp;1
+if [ $? -ne 0 ]
+then
+	echo &quot;Erro: Teste regressivo falhou. Os arquivos $1.stdout e checked/$1.stdout sao diferentes !!!&quot;
+	vimdiff $1.stdout checked/$1.stdout
+	exit 1
+fi
+
+echo &quot;Ok: Teste regressivo ok para $1.gvm&quot;
+
+exit 0
+


Property changes on: trunk/gpt2/gptvm/test/check.sh
___________________________________________________________________
Name: svn:executable
   + *

Added: trunk/gpt2/gptvm/test/check_all.sh
===================================================================
--- trunk/gpt2/gptvm/test/check_all.sh	2007-11-19 03:48:19 UTC (rev 373)
+++ trunk/gpt2/gptvm/test/check_all.sh	2007-11-19 19:53:34 UTC (rev 374)
@@ -0,0 +1,13 @@
+echo &quot;Realizando o teste regressivo em todos os arquivos .gvm do diretorio&quot;
+
+rm *.stdout 1&gt;/dev/null 2&gt;&amp;1
+
+for i in `ls *.gvm -1 | sed s/&quot;\.gvm&quot;//g`
+do
+	./check.sh $i 
+	echo &quot;&quot;
+#	if [ $? -ne 0 ]
+#	then
+#		echo &quot;Falha no teste regressivo do arquivo $i&quot;;
+#	fi
+done


Property changes on: trunk/gpt2/gptvm/test/check_all.sh
___________________________________________________________________
Name: svn:executable
   + *

Added: trunk/gpt2/gptvm/test/gerados_pelo_gptasm/constantes_1.gvm
===================================================================
(Binary files differ)


Property changes on: trunk/gpt2/gptvm/test/gerados_pelo_gptasm/constantes_1.gvm
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/gpt2/gptvm/test/gerados_pelo_gptasm/estruturas_condicionais_1.gvm
===================================================================
(Binary files differ)


Property changes on: trunk/gpt2/gptvm/test/gerados_pelo_gptasm/estruturas_condicionais_1.gvm
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/gpt2/gptvm/test/gerados_pelo_gptasm/estruturas_condicionais_2.gvm
===================================================================
(Binary files differ)


Property changes on: trunk/gpt2/gptvm/test/gerados_pelo_gptasm/estruturas_condicionais_2.gvm
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/gpt2/gptvm/test/gerados_pelo_gptasm/estruturas_condicionais_3.gvm
===================================================================
(Binary files differ)


Property changes on: trunk/gpt2/gptvm/test/gerados_pelo_gptasm/estruturas_condicionais_3.gvm
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/gpt2/gptvm/test/gerados_pelo_gptasm/estruturas_condicionais_4.gvm
===================================================================
(Binary files differ)


Property changes on: trunk/gpt2/gptvm/test/gerados_pelo_gptasm/estruturas_condicionais_4.gvm
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/gpt2/gptvm/test/gerados_pelo_gptasm/estruturas_condicionais_5.gvm
===================================================================
(Binary files differ)


Property changes on: trunk/gpt2/gptvm/test/gerados_pelo_gptasm/estruturas_condicionais_5.gvm
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/gpt2/gptvm/test/gerados_pelo_gptasm/estruturas_repeticao_1.gvm
===================================================================
(Binary files differ)


Property changes on: trunk/gpt2/gptvm/test/gerados_pelo_gptasm/estruturas_repeticao_1.gvm
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/gpt2/gptvm/test/gerados_pelo_gptasm/estruturas_repeticao_2.gvm
===================================================================
(Binary files differ)


Property changes on: trunk/gpt2/gptvm/test/gerados_pelo_gptasm/estruturas_repeticao_2.gvm
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/gpt2/gptvm/test/gerados_pelo_gptasm/estruturas_repeticao_3.gvm
===================================================================
(Binary files differ)


Property changes on: trunk/gpt2/gptvm/test/gerados_pelo_gptasm/estruturas_repeticao_3.gvm
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/gpt2/gptvm/test/gerados_pelo_gptasm/estruturas_repeticao_4.gvm
===================================================================
(Binary files differ)


Property changes on: trunk/gpt2/gptvm/test/gerados_pelo_gptasm/estruturas_repeticao_4.gvm
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/gpt2/gptvm/test/gerados_pelo_gptasm/expressoes_matematicas_1.gvm
===================================================================
(Binary files differ)


Property changes on: trunk/gpt2/gptvm/test/gerados_pelo_gptasm/expressoes_matematicas_1.gvm
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/gpt2/gptvm/test/gerados_pelo_gptasm/expressoes_matematicas_2.gvm
===================================================================
(Binary files differ)


Property changes on: trunk/gpt2/gptvm/test/gerados_pelo_gptasm/expressoes_matematicas_2.gvm
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/gpt2/gptvm/test/gerados_pelo_gptasm/funcoes_definidas_usuario_1.gvm
===================================================================
(Binary files differ)


Property changes on: trunk/gpt2/gptvm/test/gerados_pelo_gptasm/funcoes_definidas_usuario_1.gvm
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/gpt2/gptvm/test/gerados_pelo_gptasm/funcoes_definidas_usuario_2.gvm
===================================================================
(Binary files differ)


Property changes on: trunk/gpt2/gptvm/test/gerados_pelo_gptasm/funcoes_definidas_usuario_2.gvm
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/gpt2/gptvm/test/gerados_pelo_gptasm/inline_codigo_gptassembly.gvm
===================================================================
(Binary files differ)


Property changes on: trunk/gpt2/gptvm/test/gerados_pelo_gptasm/inline_codigo_gptassembly.gvm
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/gpt2/gptvm/test/gerados_pelo_gptasm/invocando_subrotinas_linguagem_1.gvm
===================================================================
(Binary files differ)


Property changes on: trunk/gpt2/gptvm/test/gerados_pelo_gptasm/invocando_subrotinas_linguagem_1.gvm
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/gpt2/gptvm/test/gerados_pelo_gptasm/invocando_subrotinas_linguagem_2.gvm
===================================================================
(Binary files differ)


Property changes on: trunk/gpt2/gptvm/test/gerados_pelo_gptasm/invocando_subrotinas_linguagem_2.gvm
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/gpt2/gptvm/test/gerados_pelo_gptasm/matrizes_1.gvm
===================================================================
(Binary files differ)


Property changes on: trunk/gpt2/gptvm/test/gerados_pelo_gptasm/matrizes_1.gvm
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/gpt2/gptvm/test/gerados_pelo_gptasm/matrizes_3.gvm
===================================================================
(Binary files differ)


Property changes on: trunk/gpt2/gptvm/test/gerados_pelo_gptasm/matrizes_3.gvm
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/gpt2/gptvm/test/gerados_pelo_gptasm/matrizes_4.gvm
===================================================================
(Binary files differ)


Property changes on: trunk/gpt2/gptvm/test/gerados_pelo_gptasm/matrizes_4.gvm
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/gpt2/gptvm/test/gerados_pelo_gptasm/procedimentos_definidos_usuario_1.gvm
===================================================================
(Binary files differ)


Property changes on: trunk/gpt2/gptvm/test/gerados_pelo_gptasm/procedimentos_definidos_usuario_1.gvm
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/gpt2/gptvm/test/gerados_pelo_gptasm/procedimentos_definidos_usuario_2.gvm
===================================================================
(Binary files differ)


Property changes on: trunk/gpt2/gptvm/test/gerados_pelo_gptasm/procedimentos_definidos_usuario_2.gvm
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/gpt2/gptvm/test/gerados_pelo_gptasm/procedimentos_definidos_usuario_3.gvm
===================================================================
(Binary files differ)


Property changes on: trunk/gpt2/gptvm/test/gerados_pelo_gptasm/procedimentos_definidos_usuario_3.gvm
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/gpt2/gptvm/test/gerados_pelo_gptasm/procedimentos_definidos_usuario_4.gvm
===================================================================
(Binary files differ)


Property changes on: trunk/gpt2/gptvm/test/gerados_pelo_gptasm/procedimentos_definidos_usuario_4.gvm
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/gpt2/gptvm/test/gerados_pelo_gptasm/variaveis_1.gvm
===================================================================
(Binary files differ)


Property changes on: trunk/gpt2/gptvm/test/gerados_pelo_gptasm/variaveis_1.gvm
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/gpt2/gptvm/test/gerados_pelo_gptasm/variaveis_2.gvm
===================================================================
(Binary files differ)


Property changes on: trunk/gpt2/gptvm/test/gerados_pelo_gptasm/variaveis_2.gvm
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/gpt2/gptvm/test/gerados_pelo_gptasm/variaveis_3.gvm
===================================================================
(Binary files differ)


Property changes on: trunk/gpt2/gptvm/test/gerados_pelo_gptasm/variaveis_3.gvm
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/gpt2/gptvm/test/gerados_pelo_gptasm/variaveis_4.gvm
===================================================================
(Binary files differ)


Property changes on: trunk/gpt2/gptvm/test/gerados_pelo_gptasm/variaveis_4.gvm
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/gpt2/gptvm/test/gerados_pelo_gptasm/variaveis_5.gvm
===================================================================
(Binary files differ)


Property changes on: trunk/gpt2/gptvm/test/gerados_pelo_gptasm/variaveis_5.gvm
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/gpt2/gptvm/test/gerados_pelo_gptasm/variaveis_6.gvm
===================================================================
(Binary files differ)


Property changes on: trunk/gpt2/gptvm/test/gerados_pelo_gptasm/variaveis_6.gvm
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/gpt2/gptvm/test/gerados_pelo_gptasm/variaveis_7.gvm
===================================================================
(Binary files differ)


Property changes on: trunk/gpt2/gptvm/test/gerados_pelo_gptasm/variaveis_7.gvm
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/gpt2/gptvm/test/gerados_pelo_gptasm/variaveis_8.gvm
===================================================================
(Binary files differ)


Property changes on: trunk/gpt2/gptvm/test/gerados_pelo_gptasm/variaveis_8.gvm
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/gpt2/gptvm/test/prep_tests.sh
===================================================================
--- trunk/gpt2/gptvm/test/prep_tests.sh	2007-11-19 03:48:19 UTC (rev 373)
+++ trunk/gpt2/gptvm/test/prep_tests.sh	2007-11-19 19:53:34 UTC (rev 374)
@@ -0,0 +1,9 @@
+cd gerados_pelo_gptasm/
+ln -s ../check_all.sh     check_all.sh
+ln -s ../check.sh         check.sh
+ln -s ../run_all.sh       run_all.sh
+ln -s ../run.sh           run.sh
+ln -s ../test_ok_all.sh   test_ok_all.sh
+ln -s ../test_ok.sh       test_ok.sh
+cd ..
+


Property changes on: trunk/gpt2/gptvm/test/prep_tests.sh
___________________________________________________________________
Name: svn:executable
   + *

Added: trunk/gpt2/gptvm/test/run.sh
===================================================================
--- trunk/gpt2/gptvm/test/run.sh	2007-11-19 03:48:19 UTC (rev 373)
+++ trunk/gpt2/gptvm/test/run.sh	2007-11-19 19:53:34 UTC (rev 374)
@@ -0,0 +1,12 @@
+rm $1.stdout 1&gt;/dev/null 2&gt;&amp;1
+
+../../gptvm $1 &gt; $1.stdout
+if [ $? -ne 0 ]
+then
+	echo &quot;Erro: nao foi possivel executar $1.gvm&quot;
+	exit 1
+fi
+echo &quot;&quot;
+
+cat $1.stdout
+


Property changes on: trunk/gpt2/gptvm/test/run.sh
___________________________________________________________________
Name: svn:executable
   + *

Added: trunk/gpt2/gptvm/test/run_all.sh
===================================================================
--- trunk/gpt2/gptvm/test/run_all.sh	2007-11-19 03:48:19 UTC (rev 373)
+++ trunk/gpt2/gptvm/test/run_all.sh	2007-11-19 19:53:34 UTC (rev 374)
@@ -0,0 +1,9 @@
+echo &quot;Executando todos os arquivos .gvm do diretorio&quot;
+
+rm *.stdout
+
+for i in `ls *.gvm -1 | sed s/&quot;\.gvm&quot;//g`
+do
+	./run.sh $i 
+	echo &quot;&quot;
+done


Property changes on: trunk/gpt2/gptvm/test/run_all.sh
___________________________________________________________________
Name: svn:executable
   + *

Added: trunk/gpt2/gptvm/test/test_ok.sh
===================================================================
--- trunk/gpt2/gptvm/test/test_ok.sh	2007-11-19 03:48:19 UTC (rev 373)
+++ trunk/gpt2/gptvm/test/test_ok.sh	2007-11-19 19:53:34 UTC (rev 374)
@@ -0,0 +1,41 @@
+function exist_file( )
+{
+	if [ -z &quot;$1&quot; ]                    # Checks if parameter #1 is zero length.
+	then
+		echo &quot;-Parameter #1 is zero length.&quot;
+		return 1
+	fi
+
+	if [ &quot;$2&quot; ] # verifica se o parametro existe
+	then
+		echo &quot;-Parameter #2 is \&quot;$2\&quot;.-&quot;
+	fi
+					  
+	if [[ ! -a $1 ]]
+	then
+		echo &quot;Erro: Arquivo $1 nao existe !!!&quot;
+		return 1
+	fi
+
+	return 0
+}
+
+
+exist_file $1.gvm
+if [ $? -ne 0 ]
+then
+	exit 2
+fi
+
+exist_file $1.stdout
+if [ $? -ne 0 ]
+then
+	exit 2
+fi
+
+echo &quot;Copiando o arquivo $1.gvm p/ o diretorio checked&quot;
+cp $1.gvm  checked/
+
+echo &quot;Copiando o arquivo $1.stdout p/ o diretorio checked&quot;
+cp $1.stdout  checked/
+


Property changes on: trunk/gpt2/gptvm/test/test_ok.sh
___________________________________________________________________
Name: svn:executable
   + *

Added: trunk/gpt2/gptvm/test/test_ok_all.sh
===================================================================
--- trunk/gpt2/gptvm/test/test_ok_all.sh	2007-11-19 03:48:19 UTC (rev 373)
+++ trunk/gpt2/gptvm/test/test_ok_all.sh	2007-11-19 19:53:34 UTC (rev 374)
@@ -0,0 +1,7 @@
+echo &quot;Executando test ok para todos os arquivos .gvm do diretorio&quot;
+
+for i in `ls *.gvm -1 | sed s/&quot;\.gvm&quot;//g`
+do
+	./test_ok.sh $i 
+	echo &quot;&quot;
+done


Property changes on: trunk/gpt2/gptvm/test/test_ok_all.sh
___________________________________________________________________
Name: svn:executable
   + *


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000047.html">[gpt-commit] r373 - in trunk/gpt2/gptc: . src test
</A></li>
	<LI>Next message: <A HREF="000049.html">[gpt-commit] r375 - trunk/gpt2/gptc/src
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#48">[ date ]</a>
              <a href="thread.html#48">[ thread ]</a>
              <a href="subject.html#48">[ subject ]</a>
              <a href="author.html#48">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/gpt-commit">More information about the gpt-commit
mailing list</a><br>
</body></html>
